<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pcilib: py.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">pcilib
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0b5c8f32f3013e7b96dc99509907414c.html">pcilib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">py.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;<a class="el" href="pcilib_8h_source.html">pcilib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="error_8h_source.html">pcilib/error.h</a>&gt;</code><br />
</div>
<p><a href="py_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a7aeb79ef38492f3294f31527bf8a441a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a7aeb79ef38492f3294f31527bf8a441a">pcilib_python_error</a>(...)&#160;&#160;&#160;<a class="el" href="py_8c.html#a9b34bb977122e0a22286923f799f1f9d">pcilib_log_python_error</a>(__FILE__, __LINE__, <a class="el" href="error_8h.html#aca11ae1da788042aeaef8fc183a1501ea658e9f66b8d198a0f65992d285521217">PCILIB_LOG_DEFAULT</a>, <a class="el" href="pcilib_8h.html#a04457557f97abc8325adf902259605bda4aaf57a57678ea897d4346af1b8503ba">PCILIB_LOG_ERROR</a>, __VA_ARGS__)</td></tr>
<tr class="separator:a7aeb79ef38492f3294f31527bf8a441a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3083fcd4c2210dffc6b5a247ba77f436"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a3083fcd4c2210dffc6b5a247ba77f436">pcilib_python_warning</a>(...)&#160;&#160;&#160;<a class="el" href="py_8c.html#a9b34bb977122e0a22286923f799f1f9d">pcilib_log_python_error</a>(__FILE__, __LINE__, <a class="el" href="error_8h.html#aca11ae1da788042aeaef8fc183a1501ea658e9f66b8d198a0f65992d285521217">PCILIB_LOG_DEFAULT</a>, <a class="el" href="pcilib_8h.html#a04457557f97abc8325adf902259605bda0b22da67d4bf5e266e89b5681d6c6061">PCILIB_LOG_WARNING</a>, __VA_ARGS__)</td></tr>
<tr class="separator:a3083fcd4c2210dffc6b5a247ba77f436"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a8a5a7e0b93848457be822f059ec10c9b"><td class="memItemLeft" align="right" valign="top">typedef struct pcilib_py_s&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a8a5a7e0b93848457be822f059ec10c9b">pcilib_py_t</a></td></tr>
<tr class="separator:a8a5a7e0b93848457be822f059ec10c9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5fef67b36b932402f62d93b7f957e6"><td class="memItemLeft" align="right" valign="top">typedef void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#acd5fef67b36b932402f62d93b7f957e6">pcilib_py_object</a></td></tr>
<tr class="separator:acd5fef67b36b932402f62d93b7f957e6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9b34bb977122e0a22286923f799f1f9d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a9b34bb977122e0a22286923f799f1f9d">pcilib_log_python_error</a> (const char *file, int line, <a class="el" href="error_8h.html#aca11ae1da788042aeaef8fc183a1501e">pcilib_log_flags_t</a> flags, <a class="el" href="pcilib_8h.html#a04457557f97abc8325adf902259605bd">pcilib_log_priority_t</a> prio, const char *msg,...)</td></tr>
<tr class="separator:a9b34bb977122e0a22286923f799f1f9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e58b4a87c12b0e76ccd6e3b09035d23"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a3e58b4a87c12b0e76ccd6e3b09035d23">pcilib_init_py</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx)</td></tr>
<tr class="memdesc:a3e58b4a87c12b0e76ccd6e3b09035d23"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes Python engine.  <a href="py_8h.html#a3e58b4a87c12b0e76ccd6e3b09035d23">More...</a><br /></td></tr>
<tr class="separator:a3e58b4a87c12b0e76ccd6e3b09035d23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67b23abbb0fa81e33525e8fd34ea28fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a67b23abbb0fa81e33525e8fd34ea28fd">pcilib_free_py</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx)</td></tr>
<tr class="memdesc:a67b23abbb0fa81e33525e8fd34ea28fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cleans up memory used by various python structures and finalyzes python environment if pcilib is not started from python script.  <a href="py_8h.html#a67b23abbb0fa81e33525e8fd34ea28fd">More...</a><br /></td></tr>
<tr class="separator:a67b23abbb0fa81e33525e8fd34ea28fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09120bdd4c55b8ee9f7db44fc55cf057"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a09120bdd4c55b8ee9f7db44fc55cf057">pcilib_py_add_script_dir</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const char *location)</td></tr>
<tr class="memdesc:a09120bdd4c55b8ee9f7db44fc55cf057"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add an additional path to look for python scripts.  <a href="py_8h.html#a09120bdd4c55b8ee9f7db44fc55cf057">More...</a><br /></td></tr>
<tr class="separator:a09120bdd4c55b8ee9f7db44fc55cf057"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6b416a298f3e8c094cd431e5b511aa0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#af6b416a298f3e8c094cd431e5b511aa0">pcilib_py_load_script</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const char *name)</td></tr>
<tr class="memdesc:af6b416a298f3e8c094cd431e5b511aa0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the specified python script.  <a href="py_8h.html#af6b416a298f3e8c094cd431e5b511aa0">More...</a><br /></td></tr>
<tr class="separator:af6b416a298f3e8c094cd431e5b511aa0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a039247bd91970425e68c485cdf912dff"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a039247bd91970425e68c485cdf912dff">pcilib_py_get_transform_script_properties</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const char *name, <a class="el" href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195c">pcilib_access_mode_t</a> *mode)</td></tr>
<tr class="memdesc:a039247bd91970425e68c485cdf912dff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the specified script can be used as transform view and detects transform configuration.  <a href="py_8h.html#a039247bd91970425e68c485cdf912dff">More...</a><br /></td></tr>
<tr class="separator:a039247bd91970425e68c485cdf912dff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1aae422e8fcc87ab4924d23e465bd5b7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="py_8h.html#acd5fef67b36b932402f62d93b7f957e6">pcilib_py_object</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a1aae422e8fcc87ab4924d23e465bd5b7">pcilib_get_value_as_pyobject</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, <a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *val, int *err)</td></tr>
<tr class="memdesc:a1aae422e8fcc87ab4924d23e465bd5b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the PyObject from the polymorphic type.  <a href="py_8h.html#a1aae422e8fcc87ab4924d23e465bd5b7">More...</a><br /></td></tr>
<tr class="separator:a1aae422e8fcc87ab4924d23e465bd5b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2dfd3853e2e918422fa93139111b61f4"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a2dfd3853e2e918422fa93139111b61f4">pcilib_set_value_from_pyobject</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, <a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *val, <a class="el" href="py_8h.html#acd5fef67b36b932402f62d93b7f957e6">pcilib_py_object</a> *pyval)</td></tr>
<tr class="memdesc:a2dfd3853e2e918422fa93139111b61f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes the polymorphic value from PyObject.  <a href="py_8h.html#a2dfd3853e2e918422fa93139111b61f4">More...</a><br /></td></tr>
<tr class="separator:a2dfd3853e2e918422fa93139111b61f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a693d92021e544dc9859742db51ea5851"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#a693d92021e544dc9859742db51ea5851">pcilib_py_eval_string</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const char *codestr, <a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *val)</td></tr>
<tr class="memdesc:a693d92021e544dc9859742db51ea5851"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates the specified python code and returns result in <b>val</b>.  <a href="py_8h.html#a693d92021e544dc9859742db51ea5851">More...</a><br /></td></tr>
<tr class="separator:a693d92021e544dc9859742db51ea5851"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6077696c99bd955d8b9fb0a1a27632b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="py_8h.html#ac6077696c99bd955d8b9fb0a1a27632b">pcilib_py_eval_func</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const char *script, const char *func, <a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *val)</td></tr>
<tr class="memdesc:ac6077696c99bd955d8b9fb0a1a27632b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute the specified function in the Python script which was loaded with <a class="el" href="py_8h.html#af6b416a298f3e8c094cd431e5b511aa0" title="Loads the specified python script.">pcilib_py_load_script()</a> call.  <a href="py_8h.html#ac6077696c99bd955d8b9fb0a1a27632b">More...</a><br /></td></tr>
<tr class="separator:ac6077696c99bd955d8b9fb0a1a27632b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a7aeb79ef38492f3294f31527bf8a441a" name="a7aeb79ef38492f3294f31527bf8a441a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7aeb79ef38492f3294f31527bf8a441a">&#9670;&#160;</a></span>pcilib_python_error</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define pcilib_python_error</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="py_8c.html#a9b34bb977122e0a22286923f799f1f9d">pcilib_log_python_error</a>(__FILE__, __LINE__, <a class="el" href="error_8h.html#aca11ae1da788042aeaef8fc183a1501ea658e9f66b8d198a0f65992d285521217">PCILIB_LOG_DEFAULT</a>, <a class="el" href="pcilib_8h.html#a04457557f97abc8325adf902259605bda4aaf57a57678ea897d4346af1b8503ba">PCILIB_LOG_ERROR</a>, __VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a3083fcd4c2210dffc6b5a247ba77f436" name="a3083fcd4c2210dffc6b5a247ba77f436"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3083fcd4c2210dffc6b5a247ba77f436">&#9670;&#160;</a></span>pcilib_python_warning</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define pcilib_python_warning</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em></td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="py_8c.html#a9b34bb977122e0a22286923f799f1f9d">pcilib_log_python_error</a>(__FILE__, __LINE__, <a class="el" href="error_8h.html#aca11ae1da788042aeaef8fc183a1501ea658e9f66b8d198a0f65992d285521217">PCILIB_LOG_DEFAULT</a>, <a class="el" href="pcilib_8h.html#a04457557f97abc8325adf902259605bda0b22da67d4bf5e266e89b5681d6c6061">PCILIB_LOG_WARNING</a>, __VA_ARGS__)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="acd5fef67b36b932402f62d93b7f957e6" name="acd5fef67b36b932402f62d93b7f957e6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5fef67b36b932402f62d93b7f957e6">&#9670;&#160;</a></span>pcilib_py_object</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void <a class="el" href="py_8h.html#acd5fef67b36b932402f62d93b7f957e6">pcilib_py_object</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8a5a7e0b93848457be822f059ec10c9b" name="a8a5a7e0b93848457be822f059ec10c9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a5a7e0b93848457be822f059ec10c9b">&#9670;&#160;</a></span>pcilib_py_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct pcilib_py_s <a class="el" href="py_8h.html#a8a5a7e0b93848457be822f059ec10c9b">pcilib_py_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a67b23abbb0fa81e33525e8fd34ea28fd" name="a67b23abbb0fa81e33525e8fd34ea28fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67b23abbb0fa81e33525e8fd34ea28fd">&#9670;&#160;</a></span>pcilib_free_py()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pcilib_free_py </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cleans up memory used by various python structures and finalyzes python environment if pcilib is not started from python script. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>- the pcilib_t context </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  322</span>                                   {</div>
<div class="line"><span class="lineno">  323</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  324</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) {</div>
<div class="line"><span class="lineno">  325</span>        PyGILState_STATE gstate;</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span>        gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">  328</span>        <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;script_hash) {</div>
<div class="line"><span class="lineno">  329</span>            pcilib_script_t *script, *script_tmp;</div>
<div class="line"><span class="lineno">  330</span> </div>
<div class="line"><span class="lineno">  331</span>            HASH_ITER(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;script_hash, script, script_tmp) {</div>
<div class="line"><span class="lineno">  332</span>                Py_DECREF(script-&gt;module);</div>
<div class="line"><span class="lineno">  333</span>                HASH_DEL(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;script_hash, script);</div>
<div class="line"><span class="lineno">  334</span>                free(script);</div>
<div class="line"><span class="lineno">  335</span>            }</div>
<div class="line"><span class="lineno">  336</span>            ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;script_hash = NULL;</div>
<div class="line"><span class="lineno">  337</span>        }</div>
<div class="line"><span class="lineno">  338</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span><span class="preprocessor">#if PY_MAJOR_VERSION &lt; 3</span></div>
<div class="line"><span class="lineno">  341</span>        pcilib_py_clean_default_modules(ctx);</div>
<div class="line"><span class="lineno">  342</span><span class="preprocessor">#endif </span><span class="comment">/* PY_MAJOR_VERSION &lt; 3 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;finalyze) {</div>
<div class="line"><span class="lineno">  345</span><span class="preprocessor">#if PY_MAJOR_VERSION &lt; 3</span></div>
<div class="line"><span class="lineno">  346</span>            Py_Finalize();</div>
<div class="line"><span class="lineno">  347</span><span class="preprocessor">#else </span><span class="comment">/* PY_MAJOR_VERSION &lt; 3 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  348</span><span class="comment">//          PyThreadState_Delete(ctx-&gt;py-&gt;tstate);</span></div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>                <span class="comment">// singal python init thread to stop and wait it to finish</span></div>
<div class="line"><span class="lineno">  351</span>            pthread_cond_signal(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;cond));</div>
<div class="line"><span class="lineno">  352</span>            pthread_mutex_unlock(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock));</div>
<div class="line"><span class="lineno">  353</span>            pthread_join(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;pth, NULL);</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>                <span class="comment">// destroy synchronization primitives</span></div>
<div class="line"><span class="lineno">  356</span>            pthread_cond_destroy(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;cond));</div>
<div class="line"><span class="lineno">  357</span>            pthread_mutex_destroy(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock));</div>
<div class="line"><span class="lineno">  358</span><span class="preprocessor">#endif </span><span class="comment">/* PY_MAJOR_VERSION &lt; 3 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  359</span>        }</div>
<div class="line"><span class="lineno">  360</span>        free(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>);</div>
<div class="line"><span class="lineno">  361</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a> = NULL;</div>
<div class="line"><span class="lineno">  362</span>    }</div>
<div class="line"><span class="lineno">  363</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  364</span>}</div>
<div class="ttc" id="astructpcilib__s_html_a61cd5975b10ad6337f87266778c6d14b"><div class="ttname"><a href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a></div><div class="ttdeci">struct pcilib_py_s * py</div><div class="ttdoc">Python execution context.</div><div class="ttdef"><b>Definition:</b> pci.h:106</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__public__api.html#ga809b61586ed9c56a7510c607859e75e3">pcilib_close()</a>, <a class="el" href="py_8c.html#a3e58b4a87c12b0e76ccd6e3b09035d23">pcilib_init_py()</a>, and <a class="el" href="group__public__api.html#gaa6d33dcd1de77fa87c66276653c164a0">pcilib_open()</a>.</p>

</div>
</div>
<a id="a1aae422e8fcc87ab4924d23e465bd5b7" name="a1aae422e8fcc87ab4924d23e465bd5b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1aae422e8fcc87ab4924d23e465bd5b7">&#9670;&#160;</a></span>pcilib_get_value_as_pyobject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="py_8h.html#acd5fef67b36b932402f62d93b7f957e6">pcilib_py_object</a> * pcilib_get_value_as_pyobject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>err</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the PyObject from the polymorphic type. </p>
<p >The returned value should be cleaned with Py_XDECREF() </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">val</td><td>- initialized polymorphic value of arbitrary type </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">err</td><td>- error code or 0 on sccuess </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- valid PyObject or NULL in the case of error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  537</span>                                                                                             {</div>
<div class="line"><span class="lineno">  538</span><span class="preprocessor">#ifdef HAVE_PYTHON      </span></div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><span class="lineno">  540</span>    PyObject *res = NULL;</div>
<div class="line"><span class="lineno">  541</span>    PyGILState_STATE gstate;</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordtype">long</span> ival;</div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordtype">double</span> fval;</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>    <span class="keywordflow">if</span> (!ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>    gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">  549</span>    <span class="keywordflow">switch</span>(val-&gt;<a class="code hl_variable" href="structpcilib__value__t.html#abbed6cb0fb2e268f175b5ca577b65dc2">type</a>) {</div>
<div class="line"><span class="lineno">  550</span>     <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pcilib_8h.html#a71a6b37faf17f39c4169e9313af66f47ad8c5c0a396e196d4800798f058c914ff">PCILIB_TYPE_LONG</a>:</div>
<div class="line"><span class="lineno">  551</span>        ival = <a class="code hl_function" href="group__public__api__value.html#gab472ccceb60ffe9b19c299ad5ad1dc02">pcilib_get_value_as_int</a>(ctx, val, &amp;err);</div>
<div class="line"><span class="lineno">  552</span>        <span class="keywordflow">if</span> (!err) res = (PyObject*)PyLong_FromLong(ival);</div>
<div class="line"><span class="lineno">  553</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  554</span>     <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="pcilib_8h.html#a71a6b37faf17f39c4169e9313af66f47a2d93b6a164cc7536c5f724188eb0791d">PCILIB_TYPE_DOUBLE</a>:</div>
<div class="line"><span class="lineno">  555</span>        fval = <a class="code hl_function" href="group__public__api__value.html#gac1728134ae3b0549231219411400be96">pcilib_get_value_as_float</a>(ctx, val, &amp;err);</div>
<div class="line"><span class="lineno">  556</span>        <span class="keywordflow">if</span> (!err) res = (PyObject*)PyFloat_FromDouble(fval);</div>
<div class="line"><span class="lineno">  557</span>        <span class="keywordflow">break</span>;  </div>
<div class="line"><span class="lineno">  558</span>     <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  559</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  560</span>        <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Can&#39;t convert pcilib value of type (%lu) to PyObject&quot;</span>, val-&gt;<a class="code hl_variable" href="structpcilib__value__t.html#abbed6cb0fb2e268f175b5ca577b65dc2">type</a>);</div>
<div class="line"><span class="lineno">  561</span>        <span class="keywordflow">if</span> (ret) *ret = <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>;</div>
<div class="line"><span class="lineno">  562</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  563</span>    }</div>
<div class="line"><span class="lineno">  564</span>    PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><span class="lineno">  567</span>        <span class="keywordflow">if</span> (ret) *ret = err;</div>
<div class="line"><span class="lineno">  568</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  569</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!res) {</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">if</span> (ret) *ret = <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">  571</span>        <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  572</span>    } </div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">if</span> (ret) *ret = 0;</div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordflow">return</span> res;</div>
<div class="line"><span class="lineno">  576</span><span class="preprocessor">#else </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  577</span>    <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Python is not supported&quot;</span>);</div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  579</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  580</span>}</div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a></div><div class="ttdeci">@ PCILIB_ERROR_MEMORY</div><div class="ttdef"><b>Definition:</b> error.h:14</div></div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a></div><div class="ttdeci">@ PCILIB_ERROR_NOTSUPPORTED</div><div class="ttdef"><b>Definition:</b> error.h:24</div></div>
<div class="ttc" id="aerror_8h_html_a2b06064fecffd095efabb752f7b50021"><div class="ttname"><a href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a></div><div class="ttdeci">#define pcilib_error(...)</div><div class="ttdef"><b>Definition:</b> error.h:68</div></div>
<div class="ttc" id="agroup__public__api__value_html_gab472ccceb60ffe9b19c299ad5ad1dc02"><div class="ttname"><a href="group__public__api__value.html#gab472ccceb60ffe9b19c299ad5ad1dc02">pcilib_get_value_as_int</a></div><div class="ttdeci">long pcilib_get_value_as_int(pcilib_t *ctx, const pcilib_value_t *val, int *err)</div><div class="ttdoc">Get the integer value from the polymorphic type.</div><div class="ttdef"><b>Definition:</b> value.c:121</div></div>
<div class="ttc" id="agroup__public__api__value_html_gac1728134ae3b0549231219411400be96"><div class="ttname"><a href="group__public__api__value.html#gac1728134ae3b0549231219411400be96">pcilib_get_value_as_float</a></div><div class="ttdeci">double pcilib_get_value_as_float(pcilib_t *ctx, const pcilib_value_t *val, int *err)</div><div class="ttdoc">Get the floating point value from the polymorphic type.</div><div class="ttdef"><b>Definition:</b> value.c:96</div></div>
<div class="ttc" id="apcilib_8h_html_a71a6b37faf17f39c4169e9313af66f47a2d93b6a164cc7536c5f724188eb0791d"><div class="ttname"><a href="pcilib_8h.html#a71a6b37faf17f39c4169e9313af66f47a2d93b6a164cc7536c5f724188eb0791d">PCILIB_TYPE_DOUBLE</a></div><div class="ttdeci">@ PCILIB_TYPE_DOUBLE</div><div class="ttdoc">double</div><div class="ttdef"><b>Definition:</b> pcilib.h:65</div></div>
<div class="ttc" id="apcilib_8h_html_a71a6b37faf17f39c4169e9313af66f47ad8c5c0a396e196d4800798f058c914ff"><div class="ttname"><a href="pcilib_8h.html#a71a6b37faf17f39c4169e9313af66f47ad8c5c0a396e196d4800798f058c914ff">PCILIB_TYPE_LONG</a></div><div class="ttdeci">@ PCILIB_TYPE_LONG</div><div class="ttdef"><b>Definition:</b> pcilib.h:66</div></div>
<div class="ttc" id="astructpcilib__value__t_html_abbed6cb0fb2e268f175b5ca577b65dc2"><div class="ttname"><a href="structpcilib__value__t.html#abbed6cb0fb2e268f175b5ca577b65dc2">pcilib_value_t::type</a></div><div class="ttdeci">pcilib_value_type_t type</div><div class="ttdoc">Current data type.</div><div class="ttdef"><b>Definition:</b> pcilib.h:124</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>, <a class="el" href="group__public__api__value.html#gac1728134ae3b0549231219411400be96">pcilib_get_value_as_float()</a>, <a class="el" href="group__public__api__value.html#gab472ccceb60ffe9b19c299ad5ad1dc02">pcilib_get_value_as_int()</a>, <a class="el" href="pcilib_8h.html#a71a6b37faf17f39c4169e9313af66f47a2d93b6a164cc7536c5f724188eb0791d">PCILIB_TYPE_DOUBLE</a>, <a class="el" href="pcilib_8h.html#a71a6b37faf17f39c4169e9313af66f47ad8c5c0a396e196d4800798f058c914ff">PCILIB_TYPE_LONG</a>, <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>, and <a class="el" href="structpcilib__value__t.html#abbed6cb0fb2e268f175b5ca577b65dc2">pcilib_value_t::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="py_8c.html#afbc32f7fcf3a5ebdc3274378ee9b5257">pcilib_py_eval_func()</a>.</p>

</div>
</div>
<a id="a3e58b4a87c12b0e76ccd6e3b09035d23" name="a3e58b4a87c12b0e76ccd6e3b09035d23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e58b4a87c12b0e76ccd6e3b09035d23">&#9670;&#160;</a></span>pcilib_init_py()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_init_py </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes Python engine. </p>
<p >This function will return success if Python support is disabled. Only functions executing python call, like <a class="el" href="py_8h.html#a693d92021e544dc9859742db51ea5851" title="Evaluates the specified python code and returns result in val.">pcilib_py_eval_string()</a>, return errors. Either way, no script directories are configured. The pcilib_add_script_dir() call is used for this purpose.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  260</span>                                  {</div>
<div class="line"><span class="lineno">  261</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  262</span>    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a> = (<a class="code hl_typedef" href="py_8h.html#a8a5a7e0b93848457be822f059ec10c9b">pcilib_py_t</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="py_8h.html#a8a5a7e0b93848457be822f059ec10c9b">pcilib_py_t</a>));</div>
<div class="line"><span class="lineno">  265</span>    <span class="keywordflow">if</span> (!ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">  266</span>    memset(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="py_8h.html#a8a5a7e0b93848457be822f059ec10c9b">pcilib_py_t</a>));</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>    <span class="keywordflow">if</span> (!Py_IsInitialized()) {</div>
<div class="line"><span class="lineno">  269</span><span class="preprocessor"># if PY_MAJOR_VERSION &lt; 3</span></div>
<div class="line"><span class="lineno">  270</span>        Py_Initialize();</div>
<div class="line"><span class="lineno">  271</span>            <span class="comment">// Since python is being initializing from c programm, it needs to initialize threads to work properly with c threads</span></div>
<div class="line"><span class="lineno">  272</span>        PyEval_InitThreads();</div>
<div class="line"><span class="lineno">  273</span>        PyEval_ReleaseLock();</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>        err = pcilib_py_load_default_modules(ctx);</div>
<div class="line"><span class="lineno">  276</span><span class="preprocessor"># else </span><span class="comment">/* PY_MAJOR_VERSION &lt; 3 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  277</span>        <span class="keywordtype">int</span> err = pthread_mutex_init(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock), NULL);</div>
<div class="line"><span class="lineno">  278</span>        <span class="keywordflow">if</span> (err) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>        err = pthread_cond_init(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;cond), NULL);</div>
<div class="line"><span class="lineno">  281</span>        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><span class="lineno">  282</span>            pthread_mutex_destroy(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock));</div>
<div class="line"><span class="lineno">  283</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  284</span>        }</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>        err = pthread_mutex_lock(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock));</div>
<div class="line"><span class="lineno">  287</span>        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><span class="lineno">  288</span>            pthread_cond_destroy(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;cond));</div>
<div class="line"><span class="lineno">  289</span>            pthread_mutex_destroy(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock));</div>
<div class="line"><span class="lineno">  290</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  291</span>        }</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>            <span class="comment">// Create initalizer thread and wait until it releases the Lock</span></div>
<div class="line"><span class="lineno">  294</span>        err = pthread_create(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;pth), NULL, pcilib_py_run_init_thread, (<span class="keywordtype">void</span>*)ctx);</div>
<div class="line"><span class="lineno">  295</span>        <span class="keywordflow">if</span> (err) {</div>
<div class="line"><span class="lineno">  296</span>            pthread_mutex_unlock(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock));</div>
<div class="line"><span class="lineno">  297</span>            pthread_cond_destroy(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;cond));</div>
<div class="line"><span class="lineno">  298</span>            pthread_mutex_destroy(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock));</div>
<div class="line"><span class="lineno">  299</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  300</span>        }</div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  302</span>            <span class="comment">// Wait until initialized and keep the lock afterwards until free executed</span></div>
<div class="line"><span class="lineno">  303</span>        pthread_cond_wait(&amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;cond), &amp;(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;lock));</div>
<div class="line"><span class="lineno">  304</span>        err = ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;status;</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span><span class="comment">//      ctx-&gt;py-&gt;tstate =  PyThreadState_New(ctx-&gt;py-&gt;istate);</span></div>
<div class="line"><span class="lineno">  307</span><span class="preprocessor"># endif </span><span class="comment">/* PY_MAJOR_VERSION &lt; 3 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  308</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;finalyze = 1;</div>
<div class="line"><span class="lineno">  309</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  310</span>        err = pcilib_py_load_default_modules(ctx);</div>
<div class="line"><span class="lineno">  311</span>    }</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><span class="lineno">  314</span>        <a class="code hl_function" href="py_8c.html#a67b23abbb0fa81e33525e8fd34ea28fd">pcilib_free_py</a>(ctx);</div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  316</span>    }</div>
<div class="line"><span class="lineno">  317</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  320</span>}</div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a></div><div class="ttdeci">@ PCILIB_ERROR_FAILED</div><div class="ttdef"><b>Definition:</b> error.h:22</div></div>
<div class="ttc" id="apy_8c_html_a67b23abbb0fa81e33525e8fd34ea28fd"><div class="ttname"><a href="py_8c.html#a67b23abbb0fa81e33525e8fd34ea28fd">pcilib_free_py</a></div><div class="ttdeci">void pcilib_free_py(pcilib_t *ctx)</div><div class="ttdoc">Cleans up memory used by various python structures and finalyzes python environment if pcilib is not ...</div><div class="ttdef"><b>Definition:</b> py.c:322</div></div>
<div class="ttc" id="apy_8h_html_a8a5a7e0b93848457be822f059ec10c9b"><div class="ttname"><a href="py_8h.html#a8a5a7e0b93848457be822f059ec10c9b">pcilib_py_t</a></div><div class="ttdeci">struct pcilib_py_s pcilib_py_t</div><div class="ttdef"><b>Definition:</b> py.h:10</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>, <a class="el" href="py_8c.html#a67b23abbb0fa81e33525e8fd34ea28fd">pcilib_free_py()</a>, and <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__public__api.html#gaa6d33dcd1de77fa87c66276653c164a0">pcilib_open()</a>.</p>

</div>
</div>
<a id="a9b34bb977122e0a22286923f799f1f9d" name="a9b34bb977122e0a22286923f799f1f9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b34bb977122e0a22286923f799f1f9d">&#9670;&#160;</a></span>pcilib_log_python_error()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pcilib_log_python_error </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>line</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="error_8h.html#aca11ae1da788042aeaef8fc183a1501e">pcilib_log_flags_t</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcilib_8h.html#a04457557f97abc8325adf902259605bd">pcilib_log_priority_t</a>&#160;</td>
          <td class="paramname"><em>prio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   55</span>                                                                                                                                     {</div>
<div class="line"><span class="lineno">   56</span>    va_list va;</div>
<div class="line"><span class="lineno">   57</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *type = NULL;</div>
<div class="line"><span class="lineno">   58</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *val = NULL;</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">   61</span>    PyGILState_STATE gstate;</div>
<div class="line"><span class="lineno">   62</span>    PyObject *pytype = NULL;</div>
<div class="line"><span class="lineno">   63</span>    PyObject *pyval = NULL;</div>
<div class="line"><span class="lineno">   64</span>    PyObject *pystr = NULL;</div>
<div class="line"><span class="lineno">   65</span>    PyObject *pytraceback = NULL;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">if</span> (PyErr_Occurred()) {</div>
<div class="line"><span class="lineno">   70</span>        PyErr_Fetch(&amp;pytype, &amp;pyval, &amp;pytraceback);</div>
<div class="line"><span class="lineno">   71</span>        PyErr_NormalizeException(&amp;pytype, &amp;pyval, &amp;pytraceback);</div>
<div class="line"><span class="lineno">   72</span>        <span class="keywordflow">if</span> (pyval) pystr = PyObject_Str(pyval);</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span><span class="preprocessor"># if PY_MAJOR_VERSION &gt;= 3</span></div>
<div class="line"><span class="lineno">   75</span>        <span class="keywordflow">if</span> (pytype) {</div>
<div class="line"><span class="lineno">   76</span>            <span class="keywordflow">if</span> (PyUnicode_Check(pytype))</div>
<div class="line"><span class="lineno">   77</span>                type = PyUnicode_AsUTF8(pytype);</div>
<div class="line"><span class="lineno">   78</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   79</span>                type = PyExceptionClass_Name(pytype);</div>
<div class="line"><span class="lineno">   80</span>        }</div>
<div class="line"><span class="lineno">   81</span>        <span class="keywordflow">if</span> (pystr) {</div>
<div class="line"><span class="lineno">   82</span>            val = PyUnicode_AsUTF8(pystr);</div>
<div class="line"><span class="lineno">   83</span>        }</div>
<div class="line"><span class="lineno">   84</span><span class="preprocessor"># else </span><span class="comment">/* PY_MAJOR_VERSION &gt;= 3 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">   85</span>        <span class="keywordflow">if</span> (pytype) {</div>
<div class="line"><span class="lineno">   86</span>            <span class="keywordflow">if</span> (PyString_Check(pytype))</div>
<div class="line"><span class="lineno">   87</span>                type = PyString_AsString(pytype);</div>
<div class="line"><span class="lineno">   88</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   89</span>                type = PyExceptionClass_Name(pytype);</div>
<div class="line"><span class="lineno">   90</span>        }</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">if</span> (pystr) {</div>
<div class="line"><span class="lineno">   92</span>            val = PyString_AsString(pystr);</div>
<div class="line"><span class="lineno">   93</span>        }</div>
<div class="line"><span class="lineno">   94</span><span class="preprocessor"># endif </span><span class="comment">/*PY_MAJOR_VERSION &gt;= 3*/</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">   95</span>    }</div>
<div class="line"><span class="lineno">   96</span>    PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">   97</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    va_start(va, msg);</div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">if</span> (type) {</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordtype">char</span> *str;</div>
<div class="line"><span class="lineno">  102</span>        <span class="keywordtype">size_t</span> len = 32;</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>        <span class="keywordflow">if</span> (msg) len += strlen(msg);</div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordflow">if</span> (type) len += strlen(type);</div>
<div class="line"><span class="lineno">  106</span>        <span class="keywordflow">if</span> (val) len += strlen(val);</div>
<div class="line"><span class="lineno">  107</span>            </div>
<div class="line"><span class="lineno">  108</span>        str = alloca(len * <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><span class="lineno">  109</span>        <span class="keywordflow">if</span> (str) {</div>
<div class="line"><span class="lineno">  110</span>            <span class="keywordflow">if</span> (msg&amp;&amp;val)</div>
<div class="line"><span class="lineno">  111</span>                sprintf(str, <span class="stringliteral">&quot;%s &lt;%s: %s&gt;&quot;</span>, msg, type, val);</div>
<div class="line"><span class="lineno">  112</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (msg)</div>
<div class="line"><span class="lineno">  113</span>                sprintf(str, <span class="stringliteral">&quot;%s &lt;%s&gt;&quot;</span>, msg, type);</div>
<div class="line"><span class="lineno">  114</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (val)</div>
<div class="line"><span class="lineno">  115</span>                sprintf(str, <span class="stringliteral">&quot;Python error %s: %s&quot;</span>, type, val);</div>
<div class="line"><span class="lineno">  116</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  117</span>                sprintf(str, <span class="stringliteral">&quot;Python error %s&quot;</span>, type);</div>
<div class="line"><span class="lineno">  118</span>            </div>
<div class="line"><span class="lineno">  119</span>            <a class="code hl_function" href="error_8c.html#a7c2cfd86f935b7d5fbe0c5970b8c0876">pcilib_log_vmessage</a>(file, line, flags, prio, str, va);</div>
<div class="line"><span class="lineno">  120</span>        }</div>
<div class="line"><span class="lineno">  121</span>    } <span class="keywordflow">else</span>  {</div>
<div class="line"><span class="lineno">  122</span>        <a class="code hl_function" href="error_8c.html#a7c2cfd86f935b7d5fbe0c5970b8c0876">pcilib_log_vmessage</a>(file, line, flags, prio, msg, va);</div>
<div class="line"><span class="lineno">  123</span>    }</div>
<div class="line"><span class="lineno">  124</span>    va_end(va);</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  127</span>    <span class="keywordflow">if</span> (pystr) Py_DECREF(pystr);</div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">if</span> (pytype) Py_DECREF(pytype);</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">if</span> (pyval) Py_DECREF(pyval);</div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">if</span> (pytraceback) Py_DECREF(pytraceback);</div>
<div class="line"><span class="lineno">  131</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  132</span>}</div>
<div class="ttc" id="aerror_8c_html_a7c2cfd86f935b7d5fbe0c5970b8c0876"><div class="ttname"><a href="error_8c.html#a7c2cfd86f935b7d5fbe0c5970b8c0876">pcilib_log_vmessage</a></div><div class="ttdeci">void pcilib_log_vmessage(const char *file, int line, pcilib_log_flags_t flags, pcilib_log_priority_t prio, const char *msg, va_list va)</div><div class="ttdef"><b>Definition:</b> error.c:69</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="error_8c.html#a7c2cfd86f935b7d5fbe0c5970b8c0876">pcilib_log_vmessage()</a>.</p>

</div>
</div>
<a id="a09120bdd4c55b8ee9f7db44fc55cf057" name="a09120bdd4c55b8ee9f7db44fc55cf057"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09120bdd4c55b8ee9f7db44fc55cf057">&#9670;&#160;</a></span>pcilib_py_add_script_dir()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_py_add_script_dir </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>location</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add an additional path to look for python scripts. </p>
<p >The default location for python files is /usr/local/share/pcilib/models/<b>model</b>. This can be altered using CMake PCILIB_MODEL_DIR variable while building or using PCILIB_MODEL_DIR environmental variable dynamicly. The default location is added with <b>location</b> = NULL. Additional directories can be added as well either by specifying relative path from the default directory or absolute path in the system.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">location</td><td>- NULL or path to additional scripts </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  366</span>                                                             {</div>
<div class="line"><span class="lineno">  367</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><span class="lineno">  369</span>    PyObject *pypath, *pynewdir;</div>
<div class="line"><span class="lineno">  370</span>    PyObject *pydict, *pystr, *pyret = NULL;</div>
<div class="line"><span class="lineno">  371</span>    <span class="keywordtype">char</span> *script_dir;</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    <span class="keywordflow">if</span> (!ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>    <span class="keyword">const</span> <span class="keywordtype">char</span> *model_dir = getenv(<span class="stringliteral">&quot;PCILIB_MODEL_DIR&quot;</span>);</div>
<div class="line"><span class="lineno">  376</span>    <span class="keywordflow">if</span> (!model_dir) model_dir = PCILIB_MODEL_DIR;</div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>    <span class="keywordflow">if</span> (!dir) dir = ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a124451df7bcbe85a2d9b7e8cb19814f9">model</a>;</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">if</span> (*dir == <span class="charliteral">&#39;/&#39;</span>) {</div>
<div class="line"><span class="lineno">  381</span>        script_dir = (<span class="keywordtype">char</span>*)dir;</div>
<div class="line"><span class="lineno">  382</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  383</span>        script_dir = alloca(strlen(model_dir) + strlen(dir) + 2);</div>
<div class="line"><span class="lineno">  384</span>        <span class="keywordflow">if</span> (!script_dir) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">  385</span>        sprintf(script_dir, <span class="stringliteral">&quot;%s/%s&quot;</span>, model_dir, dir);</div>
<div class="line"><span class="lineno">  386</span>    }</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>    PyGILState_STATE gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span>    pypath = PySys_GetObject(<span class="stringliteral">&quot;path&quot;</span>);</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">if</span> (!pypath) {</div>
<div class="line"><span class="lineno">  392</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  393</span>        <a class="code hl_define" href="py_8h.html#a3083fcd4c2210dffc6b5a247ba77f436">pcilib_python_warning</a>(<span class="stringliteral">&quot;Can&#39;t get python path&quot;</span>);</div>
<div class="line"><span class="lineno">  394</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  395</span>    }</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>    pynewdir = PyUnicode_FromString(script_dir);</div>
<div class="line"><span class="lineno">  398</span>    <span class="keywordflow">if</span> (!pynewdir) {</div>
<div class="line"><span class="lineno">  399</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  400</span>        <a class="code hl_define" href="py_8h.html#a3083fcd4c2210dffc6b5a247ba77f436">pcilib_python_warning</a>(<span class="stringliteral">&quot;Can&#39;t create python string&quot;</span>);</div>
<div class="line"><span class="lineno">  401</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">  402</span>    }</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>    <span class="comment">// Checking if the directory already in the path?</span></div>
<div class="line"><span class="lineno">  405</span>    pydict = PyDict_New();</div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordflow">if</span> (pydict) {</div>
<div class="line"><span class="lineno">  407</span>        pystr = PyUnicode_FromString(<span class="stringliteral">&quot;cur&quot;</span>);</div>
<div class="line"><span class="lineno">  408</span>        <span class="keywordflow">if</span> (pystr) {</div>
<div class="line"><span class="lineno">  409</span>            PyDict_SetItem(pydict, pystr, pynewdir);</div>
<div class="line"><span class="lineno">  410</span>            Py_DECREF(pystr);</div>
<div class="line"><span class="lineno">  411</span>        }</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>        pystr = PyUnicode_FromString(<span class="stringliteral">&quot;path&quot;</span>);</div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">if</span> (pystr) {</div>
<div class="line"><span class="lineno">  415</span>            PyDict_SetItem(pydict, pystr, pypath);</div>
<div class="line"><span class="lineno">  416</span>            Py_DECREF(pystr);</div>
<div class="line"><span class="lineno">  417</span>        }</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>        pyret = PyRun_String(<span class="stringliteral">&quot;cur in path&quot;</span>, Py_eval_input, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;global_dict, pydict);</div>
<div class="line"><span class="lineno">  420</span>        Py_DECREF(pydict);</div>
<div class="line"><span class="lineno">  421</span>    } </div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordflow">if</span> ((pyret == Py_False)&amp;&amp;(PyList_Append(pypath, pynewdir) == -1))</div>
<div class="line"><span class="lineno">  424</span>        err = <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    <span class="keywordflow">if</span> (pyret) Py_DECREF(pyret);</div>
<div class="line"><span class="lineno">  427</span>    Py_DECREF(pynewdir);</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  430</span> </div>
<div class="line"><span class="lineno">  431</span>    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><span class="lineno">  432</span>        <a class="code hl_define" href="py_8h.html#a3083fcd4c2210dffc6b5a247ba77f436">pcilib_python_warning</a>(<span class="stringliteral">&quot;Can&#39;t add directory (%s) to python path&quot;</span>, script_dir);</div>
<div class="line"><span class="lineno">  433</span>        <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  434</span>    }</div>
<div class="line"><span class="lineno">  435</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  438</span>}</div>
<div class="ttc" id="apy_8h_html_a3083fcd4c2210dffc6b5a247ba77f436"><div class="ttname"><a href="py_8h.html#a3083fcd4c2210dffc6b5a247ba77f436">pcilib_python_warning</a></div><div class="ttdeci">#define pcilib_python_warning(...)</div><div class="ttdef"><b>Definition:</b> py.h:8</div></div>
<div class="ttc" id="astructpcilib__s_html_a124451df7bcbe85a2d9b7e8cb19814f9"><div class="ttname"><a href="structpcilib__s.html#a124451df7bcbe85a2d9b7e8cb19814f9">pcilib_s::model</a></div><div class="ttdeci">char * model</div><div class="ttdoc">Requested model.</div><div class="ttdef"><b>Definition:</b> pci.h:71</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structpcilib__s.html#a124451df7bcbe85a2d9b7e8cb19814f9">pcilib_s::model</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>, <a class="el" href="py_8h.html#a3083fcd4c2210dffc6b5a247ba77f436">pcilib_python_warning</a>, and <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__public__api.html#gaa6d33dcd1de77fa87c66276653c164a0">pcilib_open()</a>.</p>

</div>
</div>
<a id="ac6077696c99bd955d8b9fb0a1a27632b" name="ac6077696c99bd955d8b9fb0a1a27632b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6077696c99bd955d8b9fb0a1a27632b">&#9670;&#160;</a></span>pcilib_py_eval_func()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_py_eval_func </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Execute the specified function in the Python script which was loaded with <a class="el" href="py_8h.html#af6b416a298f3e8c094cd431e5b511aa0" title="Loads the specified python script.">pcilib_py_load_script()</a> call. </p>
<p >The function is expected to accept two paramters. The first parameter is pcipywrap context and the <b>val</b> is passed as the second parameter. The return value of the script will be returned in the <b>val</b> as well. If function returns Py_None, the value of <b>val</b> will be unchanged.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">script</td><td>- script name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">func</td><td>- function name </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">val</td><td>- Should contain the value of second parameter of the function before call and on successful return will contain the returned value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  773</span>                                                                                                            {</div>
<div class="line"><span class="lineno">  774</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><span class="lineno">  776</span>    PyObject *pyfunc;</div>
<div class="line"><span class="lineno">  777</span>    PyObject *pyval = NULL, *pyret;</div>
<div class="line"><span class="lineno">  778</span>    pcilib_script_t *module = NULL;</div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">if</span> (!ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cac34a7253b3215c11cd04ad58314e4fed">PCILIB_ERROR_NOTINITIALIZED</a>;</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    HASH_FIND_STR(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;script_hash, script_name, module);</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordflow">if</span> (!module) {</div>
<div class="line"><span class="lineno">  785</span>        <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Script (%s) is not loaded&quot;</span>, script_name);</div>
<div class="line"><span class="lineno">  786</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cad21a896d5d5aaee0682c410b9bed283c">PCILIB_ERROR_NOTFOUND</a>;</div>
<div class="line"><span class="lineno">  787</span>    }</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>    <span class="keywordflow">if</span> (val) {</div>
<div class="line"><span class="lineno">  790</span>        pyval = <a class="code hl_function" href="py_8c.html#a664085367004b356c71e1058b0cf0eed">pcilib_get_value_as_pyobject</a>(ctx, val, &amp;err);</div>
<div class="line"><span class="lineno">  791</span>        <span class="keywordflow">if</span> (err) <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  792</span>    }</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>    PyGILState_STATE gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>    pyfunc = PyUnicode_FromString(func_name);</div>
<div class="line"><span class="lineno">  797</span>    <span class="keywordflow">if</span> (!pyfunc) {</div>
<div class="line"><span class="lineno">  798</span>        <span class="keywordflow">if</span> (pyval) Py_DECREF(pyval);</div>
<div class="line"><span class="lineno">  799</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  800</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">  801</span>    }</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>    pyret = PyObject_CallMethodObjArgs(module-&gt;module, pyfunc, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;pcilib_pywrap, pyval, NULL);</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>    Py_DECREF(pyfunc);</div>
<div class="line"><span class="lineno">  806</span>    Py_DECREF(pyval);</div>
<div class="line"><span class="lineno">  807</span>        </div>
<div class="line"><span class="lineno">  808</span>    <span class="keywordflow">if</span> (!pyret) {</div>
<div class="line"><span class="lineno">  809</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  810</span>        <a class="code hl_define" href="py_8h.html#a7aeb79ef38492f3294f31527bf8a441a">pcilib_python_error</a>(<span class="stringliteral">&quot;Error executing function (%s) of python script (%s)&quot;</span>, func_name, script_name);</div>
<div class="line"><span class="lineno">  811</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  812</span>    }</div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span>    <span class="keywordflow">if</span> ((val)&amp;&amp;(pyret != Py_None))</div>
<div class="line"><span class="lineno">  815</span>        err = <a class="code hl_function" href="py_8c.html#afb9b3ce9b053e3a90e06e30cb905aec5">pcilib_set_value_from_pyobject</a>(ctx, val, pyret);</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>    Py_DECREF(pyret);</div>
<div class="line"><span class="lineno">  818</span>    PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>    <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  821</span><span class="preprocessor">#else </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  822</span>    <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Python is not supported&quot;</span>);</div>
<div class="line"><span class="lineno">  823</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>;</div>
<div class="line"><span class="lineno">  824</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  825</span>}</div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60cac34a7253b3215c11cd04ad58314e4fed"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60cac34a7253b3215c11cd04ad58314e4fed">PCILIB_ERROR_NOTINITIALIZED</a></div><div class="ttdeci">@ PCILIB_ERROR_NOTINITIALIZED</div><div class="ttdef"><b>Definition:</b> error.h:28</div></div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60cad21a896d5d5aaee0682c410b9bed283c"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60cad21a896d5d5aaee0682c410b9bed283c">PCILIB_ERROR_NOTFOUND</a></div><div class="ttdeci">@ PCILIB_ERROR_NOTFOUND</div><div class="ttdef"><b>Definition:</b> error.h:25</div></div>
<div class="ttc" id="apy_8c_html_a664085367004b356c71e1058b0cf0eed"><div class="ttname"><a href="py_8c.html#a664085367004b356c71e1058b0cf0eed">pcilib_get_value_as_pyobject</a></div><div class="ttdeci">pcilib_py_object * pcilib_get_value_as_pyobject(pcilib_t *ctx, pcilib_value_t *val, int *ret)</div><div class="ttdoc">Get the PyObject from the polymorphic type.</div><div class="ttdef"><b>Definition:</b> py.c:537</div></div>
<div class="ttc" id="apy_8c_html_afb9b3ce9b053e3a90e06e30cb905aec5"><div class="ttname"><a href="py_8c.html#afb9b3ce9b053e3a90e06e30cb905aec5">pcilib_set_value_from_pyobject</a></div><div class="ttdeci">int pcilib_set_value_from_pyobject(pcilib_t *ctx, pcilib_value_t *val, pcilib_py_object *pval)</div><div class="ttdoc">Initializes the polymorphic value from PyObject.</div><div class="ttdef"><b>Definition:</b> py.c:582</div></div>
<div class="ttc" id="apy_8h_html_a7aeb79ef38492f3294f31527bf8a441a"><div class="ttname"><a href="py_8h.html#a7aeb79ef38492f3294f31527bf8a441a">pcilib_python_error</a></div><div class="ttdeci">#define pcilib_python_error(...)</div><div class="ttdef"><b>Definition:</b> py.h:7</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cad21a896d5d5aaee0682c410b9bed283c">PCILIB_ERROR_NOTFOUND</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cac34a7253b3215c11cd04ad58314e4fed">PCILIB_ERROR_NOTINITIALIZED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>, <a class="el" href="py_8c.html#a664085367004b356c71e1058b0cf0eed">pcilib_get_value_as_pyobject()</a>, <a class="el" href="py_8h.html#a7aeb79ef38492f3294f31527bf8a441a">pcilib_python_error</a>, <a class="el" href="py_8c.html#afb9b3ce9b053e3a90e06e30cb905aec5">pcilib_set_value_from_pyobject()</a>, and <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>.</p>

</div>
</div>
<a id="a693d92021e544dc9859742db51ea5851" name="a693d92021e544dc9859742db51ea5851"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a693d92021e544dc9859742db51ea5851">&#9670;&#160;</a></span>pcilib_py_eval_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_py_eval_string </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>codestr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *&#160;</td>
          <td class="paramname"><em>val</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Evaluates the specified python code and returns result in <b>val</b>. </p>
<p >The python code may include special variables which will be substituted by pcitool before executing Python interpreter <b>$value</b> - will be replaced by the current value of the <b>val</b> parameter <b>$reg</b> - will be replaced by the current value of the specified register <b>reg</b> <b>${/prop/temp}</b> - will be replaced by the current value of the specified property <b>/prop/temp</b> <b>${/prop/temp</b>:C} - will be replaced by the current value of the specified property <b>/prop/temp</b> in the given units</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">codestr</td><td>- python code to evaluate </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">val</td><td>- Should contain the value which will be substituted in place of <b>$value</b> and on successful execution will contain the computed value </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  734</span>                                                                                     {</div>
<div class="line"><span class="lineno">  735</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordtype">int</span> err;</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>    PyGILState_STATE gstate;</div>
<div class="line"><span class="lineno">  739</span>    <span class="keywordtype">char</span> *code;</div>
<div class="line"><span class="lineno">  740</span>    PyObject* obj;</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">if</span> (!ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cac34a7253b3215c11cd04ad58314e4fed">PCILIB_ERROR_NOTINITIALIZED</a>;</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>    code = pcilib_py_parse_string(ctx, codestr, value);</div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">if</span> (!code) {</div>
<div class="line"><span class="lineno">  746</span>        <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Failed to parse registers in the code: %s&quot;</span>, codestr);</div>
<div class="line"><span class="lineno">  747</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  748</span>    }</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">  751</span>    obj = PyRun_String(code, Py_eval_input, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;global_dict, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;global_dict);</div>
<div class="line"><span class="lineno">  752</span>    PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordflow">if</span> (!obj) {</div>
<div class="line"><span class="lineno">  755</span>        <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Failed to run the Python code: %s&quot;</span>, code);</div>
<div class="line"><span class="lineno">  756</span>        free(code);</div>
<div class="line"><span class="lineno">  757</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  758</span>    }</div>
<div class="line"><span class="lineno">  759</span> </div>
<div class="line"><span class="lineno">  760</span>    <a class="code hl_define" href="debug_8h.html#a7b5a103312fce99fe368c5e8f0527979">pcilib_debug</a>(VIEWS, <span class="stringliteral">&quot;Evaluating a Python string \&#39;%s\&#39; to %lf=\&#39;%s\&#39;&quot;</span>, codestr, PyFloat_AsDouble(obj), code);</div>
<div class="line"><span class="lineno">  761</span>    err = <a class="code hl_function" href="group__public__api__value.html#gac4b8a89d0f820a8466b135c0644e0a00">pcilib_set_value_from_float</a>(ctx, value, PyFloat_AsDouble(obj));</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>    Py_DECREF(obj);</div>
<div class="line"><span class="lineno">  764</span>    free(code);</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  767</span><span class="preprocessor">#else </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  768</span>        <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Current build not support python.&quot;</span>);</div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca2c7b7e157ef8c29a7d1d0e808acf0a4c">PCILIB_ERROR_NOTAVAILABLE</a>;</div>
<div class="line"><span class="lineno">  770</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  771</span>}</div>
<div class="ttc" id="adebug_8h_html_a7b5a103312fce99fe368c5e8f0527979"><div class="ttname"><a href="debug_8h.html#a7b5a103312fce99fe368c5e8f0527979">pcilib_debug</a></div><div class="ttdeci">#define pcilib_debug(function,...)</div><div class="ttdef"><b>Definition:</b> debug.h:41</div></div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60ca2c7b7e157ef8c29a7d1d0e808acf0a4c"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca2c7b7e157ef8c29a7d1d0e808acf0a4c">PCILIB_ERROR_NOTAVAILABLE</a></div><div class="ttdeci">@ PCILIB_ERROR_NOTAVAILABLE</div><div class="ttdef"><b>Definition:</b> error.h:27</div></div>
<div class="ttc" id="agroup__public__api__value_html_gac4b8a89d0f820a8466b135c0644e0a00"><div class="ttname"><a href="group__public__api__value.html#gac4b8a89d0f820a8466b135c0644e0a00">pcilib_set_value_from_float</a></div><div class="ttdeci">int pcilib_set_value_from_float(pcilib_t *ctx, pcilib_value_t *val, double fval)</div><div class="ttdoc">Initializes the polymorphic value from floating-point number.</div><div class="ttdef"><b>Definition:</b> value.c:44</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="debug_8h.html#a7b5a103312fce99fe368c5e8f0527979">pcilib_debug</a>, <a class="el" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca2c7b7e157ef8c29a7d1d0e808acf0a4c">PCILIB_ERROR_NOTAVAILABLE</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cac34a7253b3215c11cd04ad58314e4fed">PCILIB_ERROR_NOTINITIALIZED</a>, <a class="el" href="group__public__api__value.html#gac4b8a89d0f820a8466b135c0644e0a00">pcilib_set_value_from_float()</a>, and <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>.</p>

<p class="reference">Referenced by <a class="el" href="unit_8c.html#a95f01e52d74bdb197b8c37466f854263">pcilib_transform_unit()</a>.</p>

</div>
</div>
<a id="a039247bd91970425e68c485cdf912dff" name="a039247bd91970425e68c485cdf912dff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a039247bd91970425e68c485cdf912dff">&#9670;&#160;</a></span>pcilib_py_get_transform_script_properties()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_py_get_transform_script_properties </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195c">pcilib_access_mode_t</a> *&#160;</td>
          <td class="paramname"><em>mode</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the specified script can be used as transform view and detects transform configuration. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>- script name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">mode</td><td>- supported access mode (read/write/read-write) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  486</span>                                                                                                                      {</div>
<div class="line"><span class="lineno">  487</span>    <a class="code hl_enumeration" href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195c">pcilib_access_mode_t</a> mode = 0;</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  490</span>    PyObject *dict;</div>
<div class="line"><span class="lineno">  491</span>    PyObject *pystr;</div>
<div class="line"><span class="lineno">  492</span>    pcilib_script_t *module;</div>
<div class="line"><span class="lineno">  493</span>    PyGILState_STATE gstate;</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>    <span class="keywordflow">if</span> (!ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) {</div>
<div class="line"><span class="lineno">  496</span>        <span class="keywordflow">if</span> (mode_ret) *mode_ret = mode;</div>
<div class="line"><span class="lineno">  497</span>        <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  498</span>    }</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>    HASH_FIND_STR(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;script_hash, script_name, module);</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>    <span class="keywordflow">if</span>(!module) {</div>
<div class="line"><span class="lineno">  503</span>        <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Script (%s) is not loaded yet&quot;</span>, script_name);</div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cad21a896d5d5aaee0682c410b9bed283c">PCILIB_ERROR_NOTFOUND</a>;</div>
<div class="line"><span class="lineno">  505</span>    }</div>
<div class="line"><span class="lineno">  506</span>    </div>
<div class="line"><span class="lineno">  507</span>    gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">  508</span>        </div>
<div class="line"><span class="lineno">  509</span>    dict = PyModule_GetDict(module-&gt;module);</div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordflow">if</span> (!dict) {</div>
<div class="line"><span class="lineno">  511</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  512</span>        <a class="code hl_define" href="py_8h.html#a7aeb79ef38492f3294f31527bf8a441a">pcilib_python_error</a>(<span class="stringliteral">&quot;Error getting dictionary for script (%s)&quot;</span>, script_name);</div>
<div class="line"><span class="lineno">  513</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  514</span>    }</div>
<div class="line"><span class="lineno">  515</span>    </div>
<div class="line"><span class="lineno">  516</span>    pystr = PyUnicode_FromString(<span class="stringliteral">&quot;read_from_register&quot;</span>);</div>
<div class="line"><span class="lineno">  517</span>    <span class="keywordflow">if</span> (pystr) {</div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordflow">if</span> (PyDict_Contains(dict, pystr)) mode |= <a class="code hl_enumvalue" href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195cab74aef0537a09893f01e1d30a1c0b394">PCILIB_ACCESS_R</a>;</div>
<div class="line"><span class="lineno">  519</span>        Py_DECREF(pystr);</div>
<div class="line"><span class="lineno">  520</span>    }</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    pystr = PyUnicode_FromString(<span class="stringliteral">&quot;write_to_register&quot;</span>);</div>
<div class="line"><span class="lineno">  523</span>    <span class="keywordflow">if</span> (pystr) {</div>
<div class="line"><span class="lineno">  524</span>        <span class="keywordflow">if</span> (PyDict_Contains(dict, pystr)) mode |= <a class="code hl_enumvalue" href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195cad7f0257b310e53a799126f97897323a2">PCILIB_ACCESS_W</a>;</div>
<div class="line"><span class="lineno">  525</span>        Py_DECREF(pystr);</div>
<div class="line"><span class="lineno">  526</span>    }</div>
<div class="line"><span class="lineno">  527</span>    </div>
<div class="line"><span class="lineno">  528</span>    PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  529</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span><span class="comment">//    pcilib_py_load_default_modules(py-&gt;ctx);</span></div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    <span class="keywordflow">if</span> (mode_ret) *mode_ret = mode;</div>
<div class="line"><span class="lineno">  534</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  535</span>}</div>
<div class="ttc" id="apcilib_8h_html_abd48d7a4e54caa538ad13634fabf195c"><div class="ttname"><a href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195c">pcilib_access_mode_t</a></div><div class="ttdeci">pcilib_access_mode_t</div><div class="ttdef"><b>Definition:</b> pcilib.h:43</div></div>
<div class="ttc" id="apcilib_8h_html_abd48d7a4e54caa538ad13634fabf195cab74aef0537a09893f01e1d30a1c0b394"><div class="ttname"><a href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195cab74aef0537a09893f01e1d30a1c0b394">PCILIB_ACCESS_R</a></div><div class="ttdeci">@ PCILIB_ACCESS_R</div><div class="ttdoc">getting property is allowed</div><div class="ttdef"><b>Definition:</b> pcilib.h:44</div></div>
<div class="ttc" id="apcilib_8h_html_abd48d7a4e54caa538ad13634fabf195cad7f0257b310e53a799126f97897323a2"><div class="ttname"><a href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195cad7f0257b310e53a799126f97897323a2">PCILIB_ACCESS_W</a></div><div class="ttdeci">@ PCILIB_ACCESS_W</div><div class="ttdoc">setting property is allowed</div><div class="ttdef"><b>Definition:</b> pcilib.h:45</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195cab74aef0537a09893f01e1d30a1c0b394">PCILIB_ACCESS_R</a>, <a class="el" href="pcilib_8h.html#abd48d7a4e54caa538ad13634fabf195cad7f0257b310e53a799126f97897323a2">PCILIB_ACCESS_W</a>, <a class="el" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cad21a896d5d5aaee0682c410b9bed283c">PCILIB_ERROR_NOTFOUND</a>, <a class="el" href="py_8h.html#a7aeb79ef38492f3294f31527bf8a441a">pcilib_python_error</a>, and <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>.</p>

</div>
</div>
<a id="af6b416a298f3e8c094cd431e5b511aa0" name="af6b416a298f3e8c094cd431e5b511aa0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6b416a298f3e8c094cd431e5b511aa0">&#9670;&#160;</a></span>pcilib_py_load_script()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_py_load_script </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the specified python script. </p>
<p >Once loaded the script is available until pcilib context is destryoed.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>- script name, the passed variable is referenced and, hence, should have static duration </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  441</span>                                                                  {</div>
<div class="line"><span class="lineno">  442</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  443</span>    PyObject* pymodule;</div>
<div class="line"><span class="lineno">  444</span>    pcilib_script_t *module = NULL;</div>
<div class="line"><span class="lineno">  445</span>    PyGILState_STATE gstate;</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordflow">if</span> (!ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordtype">char</span> *module_name = strdupa(script_name);</div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">if</span> (!module_name) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>    <span class="keywordtype">char</span> *py = strrchr(module_name, <span class="charliteral">&#39;.&#39;</span>);</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">if</span> ((!py)||(strcasecmp(py, <span class="stringliteral">&quot;.py&quot;</span>))) {</div>
<div class="line"><span class="lineno">  454</span>        <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Invalid script name (%s) is specified&quot;</span>, script_name);</div>
<div class="line"><span class="lineno">  455</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca1d5267b325c591675a462cefbb1d0f7f">PCILIB_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><span class="lineno">  456</span>    }</div>
<div class="line"><span class="lineno">  457</span>    *py = 0;</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span>    HASH_FIND_STR(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;script_hash, script_name, module);</div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">if</span> (module) <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>    gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">  463</span>    pymodule = PyImport_ImportModule(module_name);</div>
<div class="line"><span class="lineno">  464</span>    <span class="keywordflow">if</span> (!pymodule) {</div>
<div class="line"><span class="lineno">  465</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  466</span>        <a class="code hl_define" href="py_8h.html#a7aeb79ef38492f3294f31527bf8a441a">pcilib_python_error</a>(<span class="stringliteral">&quot;Error importing script (%s)&quot;</span>, script_name);</div>
<div class="line"><span class="lineno">  467</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  468</span>    }</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    module = (pcilib_script_t*)malloc(<span class="keyword">sizeof</span>(pcilib_script_t));</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordflow">if</span> (!module) {</div>
<div class="line"><span class="lineno">  472</span>        Py_DECREF(pymodule);</div>
<div class="line"><span class="lineno">  473</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  474</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">  475</span>    }</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>    module-&gt;module = pymodule;</div>
<div class="line"><span class="lineno">  480</span>    module-&gt;name = script_name;</div>
<div class="line"><span class="lineno">  481</span>    HASH_ADD_KEYPTR(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>-&gt;script_hash, module-&gt;name, strlen(module-&gt;name), module);</div>
<div class="line"><span class="lineno">  482</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  483</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  484</span>}</div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60ca1d5267b325c591675a462cefbb1d0f7f"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca1d5267b325c591675a462cefbb1d0f7f">PCILIB_ERROR_INVALID_ARGUMENT</a></div><div class="ttdeci">@ PCILIB_ERROR_INVALID_ARGUMENT</div><div class="ttdef"><b>Definition:</b> error.h:20</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca1d5267b325c591675a462cefbb1d0f7f">PCILIB_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>, <a class="el" href="py_8h.html#a7aeb79ef38492f3294f31527bf8a441a">pcilib_python_error</a>, and <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>.</p>

</div>
</div>
<a id="a2dfd3853e2e918422fa93139111b61f4" name="a2dfd3853e2e918422fa93139111b61f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2dfd3853e2e918422fa93139111b61f4">&#9670;&#160;</a></span>pcilib_set_value_from_pyobject()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_set_value_from_pyobject </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *&#160;</td>
          <td class="paramname"><em>val</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="py_8h.html#acd5fef67b36b932402f62d93b7f957e6">pcilib_py_object</a> *&#160;</td>
          <td class="paramname"><em>pyval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes the polymorphic value from PyObject. </p>
<p >If <code>val</code> already contains the value, cleans it first. Therefore, before first usage the value should be always initialized to 0. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">val</td><td>- initialized polymorphic value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pyval</td><td>- valid PyObject* containing PyInt, PyFloat, or PyString </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- 0 on success or memory error </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  582</span>                                                                                               {</div>
<div class="line"><span class="lineno">  583</span><span class="preprocessor">#ifdef HAVE_PYTHON</span></div>
<div class="line"><span class="lineno">  584</span>    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><span class="lineno">  585</span>    PyObject *pyval = (PyObject*)pval;</div>
<div class="line"><span class="lineno">  586</span>    PyGILState_STATE gstate;</div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span>    <span class="keywordflow">if</span> (!ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">py</a>) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cac34a7253b3215c11cd04ad58314e4fed">PCILIB_ERROR_NOTINITIALIZED</a>;</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>    gstate = PyGILState_Ensure();</div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordflow">if</span> (PyLong_Check(pyval)) {</div>
<div class="line"><span class="lineno">  592</span>        err = <a class="code hl_function" href="group__public__api__value.html#gabe06d2df9bcf73f925a60826a9f61bd7">pcilib_set_value_from_int</a>(ctx, val, PyLong_AsLong(pyval));</div>
<div class="line"><span class="lineno">  593</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyFloat_Check(pyval)) {</div>
<div class="line"><span class="lineno">  594</span>        err = <a class="code hl_function" href="group__public__api__value.html#gac4b8a89d0f820a8466b135c0644e0a00">pcilib_set_value_from_float</a>(ctx, val, PyFloat_AsDouble(pyval));</div>
<div class="line"><span class="lineno">  595</span><span class="preprocessor">#if PY_MAJOR_VERSION &lt; 3</span></div>
<div class="line"><span class="lineno">  596</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyInt_Check(pyval)) {</div>
<div class="line"><span class="lineno">  597</span>        err = <a class="code hl_function" href="group__public__api__value.html#gabe06d2df9bcf73f925a60826a9f61bd7">pcilib_set_value_from_int</a>(ctx, val, PyInt_AsLong(pyval));</div>
<div class="line"><span class="lineno">  598</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyString_Check(pyval)) {</div>
<div class="line"><span class="lineno">  599</span>        err = <a class="code hl_function" href="group__public__api__value.html#gac31c2e7e04199e648f5f59834e674c78">pcilib_set_value_from_string</a>(ctx, val, PyString_AsString(pyval));</div>
<div class="line"><span class="lineno">  600</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyUnicode_Check(pyval)) {</div>
<div class="line"><span class="lineno">  601</span>        PyObject *buf = PyUnicode_AsASCIIString(pyval);</div>
<div class="line"><span class="lineno">  602</span>        <span class="keywordflow">if</span> (buf) {</div>
<div class="line"><span class="lineno">  603</span>            err = <a class="code hl_function" href="group__public__api__value.html#gac31c2e7e04199e648f5f59834e674c78">pcilib_set_value_from_string</a>(ctx, val, PyString_AsString(buf));</div>
<div class="line"><span class="lineno">  604</span>            Py_DecRef(buf);</div>
<div class="line"><span class="lineno">  605</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  606</span>            err = <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>;</div>
<div class="line"><span class="lineno">  607</span>        }</div>
<div class="line"><span class="lineno">  608</span><span class="preprocessor">#else </span><span class="comment">/* PY_MAJOR_VERSION &lt; 3 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  609</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (PyUnicode_Check(pyval)) {</div>
<div class="line"><span class="lineno">  610</span>        err = <a class="code hl_function" href="group__public__api__value.html#gac31c2e7e04199e648f5f59834e674c78">pcilib_set_value_from_string</a>(ctx, val, PyUnicode_AsUTF8(pyval));</div>
<div class="line"><span class="lineno">  611</span><span class="preprocessor">#endif </span><span class="comment">/* PY_MAJOR_VERSION &lt; 3 */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  612</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  613</span>        PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  614</span>        <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Can&#39;t convert PyObject to polymorphic pcilib value&quot;</span>);</div>
<div class="line"><span class="lineno">  615</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>;</div>
<div class="line"><span class="lineno">  616</span>    }</div>
<div class="line"><span class="lineno">  617</span>    PyGILState_Release(gstate);</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  620</span><span class="preprocessor">#else </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  621</span>    <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Python is not supported&quot;</span>);</div>
<div class="line"><span class="lineno">  622</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>;</div>
<div class="line"><span class="lineno">  623</span><span class="preprocessor">#endif </span><span class="comment">/* HAVE_PYTHON */</span><span class="preprocessor"></span></div>
<div class="line"><span class="lineno">  624</span>}</div>
<div class="ttc" id="agroup__public__api__value_html_gabe06d2df9bcf73f925a60826a9f61bd7"><div class="ttname"><a href="group__public__api__value.html#gabe06d2df9bcf73f925a60826a9f61bd7">pcilib_set_value_from_int</a></div><div class="ttdeci">int pcilib_set_value_from_int(pcilib_t *ctx, pcilib_value_t *val, long ival)</div><div class="ttdoc">Initializes the polymorphic value from integer.</div><div class="ttdef"><b>Definition:</b> value.c:53</div></div>
<div class="ttc" id="agroup__public__api__value_html_gac31c2e7e04199e648f5f59834e674c78"><div class="ttname"><a href="group__public__api__value.html#gac31c2e7e04199e648f5f59834e674c78">pcilib_set_value_from_string</a></div><div class="ttdeci">int pcilib_set_value_from_string(pcilib_t *ctx, pcilib_value_t *val, const char *str)</div><div class="ttdoc">Initializes the polymorphic value from the string.</div><div class="ttdef"><b>Definition:</b> value.c:75</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca8a1b45502224b7b2659e0014d9acf50c">PCILIB_ERROR_FAILED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60cac34a7253b3215c11cd04ad58314e4fed">PCILIB_ERROR_NOTINITIALIZED</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>, <a class="el" href="group__public__api__value.html#gac4b8a89d0f820a8466b135c0644e0a00">pcilib_set_value_from_float()</a>, <a class="el" href="group__public__api__value.html#gabe06d2df9bcf73f925a60826a9f61bd7">pcilib_set_value_from_int()</a>, <a class="el" href="group__public__api__value.html#gac31c2e7e04199e648f5f59834e674c78">pcilib_set_value_from_string()</a>, and <a class="el" href="structpcilib__s.html#a61cd5975b10ad6337f87266778c6d14b">pcilib_s::py</a>.</p>

<p class="reference">Referenced by <a class="el" href="py_8c.html#afbc32f7fcf3a5ebdc3274378ee9b5257">pcilib_py_eval_func()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 18 2024 22:02:48 for pcilib by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
