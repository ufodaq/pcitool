<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pcilib: register.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">pcilib
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0b5c8f32f3013e7b96dc99509907414c.html">pcilib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">register.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;uthash.h&gt;</code><br />
<code>#include &lt;<a class="el" href="pcilib_8h_source.html">pcilib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="bank_8h_source.html">pcilib/bank.h</a>&gt;</code><br />
</div>
<p><a href="register_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpcilib__view__reference__t.html">pcilib_view_reference_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpcilib__register__description__t.html">pcilib_register_description_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpcilib__register__context__t.html">pcilib_register_context_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a0d4f05a296df5b3fc9b9e7338b2b3ae1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="register_8h.html#a0d4f05a296df5b3fc9b9e7338b2b3ae1">PCILIB_REGISTER_NO_BITS</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a0d4f05a296df5b3fc9b9e7338b2b3ae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acda92190b7d34e84dbf6b1c81c7a8da7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="register_8h.html#acda92190b7d34e84dbf6b1c81c7a8da7">PCILIB_REGISTER_ALL_BITS</a>&#160;&#160;&#160;((<a class="el" href="pcilib_8h.html#acb54b82c4cfdb69491465e3c94dadf75">pcilib_register_value_t</a>)-1)</td></tr>
<tr class="separator:acda92190b7d34e84dbf6b1c81c7a8da7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="enum-members" name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aa0464147a2747278f50b0de1764b17a4"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4">pcilib_register_type_t</a> { <a class="el" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4a4cec83c230e00bff1d734a952b23953f">PCILIB_REGISTER_STANDARD</a> = 0
, <a class="el" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4af46c7bd4435f64b53ae56a05599a6658">PCILIB_REGISTER_FIFO</a>
, <a class="el" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4afe7976e5c780ed21c27e4de162f0d9ac">PCILIB_REGISTER_BITS</a>
, <a class="el" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4a5940cbb4559e3a945d8502202ef8690c">PCILIB_REGISTER_PROPERTY</a>
 }</td></tr>
<tr class="separator:aa0464147a2747278f50b0de1764b17a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aec9a0672eddac26362760345cea77508"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="register_8h.html#aec9a0672eddac26362760345cea77508">pcilib_add_registers</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, <a class="el" href="bank_8h.html#ab2b604364494c4bb061e3c8ff75b3565">pcilib_model_modification_flags_t</a> flags, size_t n, const <a class="el" href="structpcilib__register__description__t.html">pcilib_register_description_t</a> *registers, <a class="el" href="pcilib_8h.html#a64d66d93f7c4755e67c113b370f982d0">pcilib_register_t</a> *ids)</td></tr>
<tr class="memdesc:aec9a0672eddac26362760345cea77508"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use this function to add new registers into the model.  <a href="register_8h.html#aec9a0672eddac26362760345cea77508">More...</a><br /></td></tr>
<tr class="separator:aec9a0672eddac26362760345cea77508"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4fadb52b2487bc1196be90a9bcf09fdc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="register_8h.html#a4fadb52b2487bc1196be90a9bcf09fdc">pcilib_clean_registers</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, <a class="el" href="pcilib_8h.html#a64d66d93f7c4755e67c113b370f982d0">pcilib_register_t</a> start)</td></tr>
<tr class="memdesc:a4fadb52b2487bc1196be90a9bcf09fdc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys data associated with registers.  <a href="register_8h.html#a4fadb52b2487bc1196be90a9bcf09fdc">More...</a><br /></td></tr>
<tr class="separator:a4fadb52b2487bc1196be90a9bcf09fdc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="acda92190b7d34e84dbf6b1c81c7a8da7" name="acda92190b7d34e84dbf6b1c81c7a8da7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acda92190b7d34e84dbf6b1c81c7a8da7">&#9670;&#160;</a></span>PCILIB_REGISTER_ALL_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PCILIB_REGISTER_ALL_BITS&#160;&#160;&#160;((<a class="el" href="pcilib_8h.html#acb54b82c4cfdb69491465e3c94dadf75">pcilib_register_value_t</a>)-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a0d4f05a296df5b3fc9b9e7338b2b3ae1" name="a0d4f05a296df5b3fc9b9e7338b2b3ae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d4f05a296df5b3fc9b9e7338b2b3ae1">&#9670;&#160;</a></span>PCILIB_REGISTER_NO_BITS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PCILIB_REGISTER_NO_BITS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aa0464147a2747278f50b0de1764b17a4" name="aa0464147a2747278f50b0de1764b17a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0464147a2747278f50b0de1764b17a4">&#9670;&#160;</a></span>pcilib_register_type_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4">pcilib_register_type_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aa0464147a2747278f50b0de1764b17a4a4cec83c230e00bff1d734a952b23953f" name="aa0464147a2747278f50b0de1764b17a4a4cec83c230e00bff1d734a952b23953f"></a>PCILIB_REGISTER_STANDARD&#160;</td><td class="fielddoc"><p >Standard register. </p>
</td></tr>
<tr><td class="fieldname"><a id="aa0464147a2747278f50b0de1764b17a4af46c7bd4435f64b53ae56a05599a6658" name="aa0464147a2747278f50b0de1764b17a4af46c7bd4435f64b53ae56a05599a6658"></a>PCILIB_REGISTER_FIFO&#160;</td><td class="fielddoc"><p >FIFO register. </p>
</td></tr>
<tr><td class="fieldname"><a id="aa0464147a2747278f50b0de1764b17a4afe7976e5c780ed21c27e4de162f0d9ac" name="aa0464147a2747278f50b0de1764b17a4afe7976e5c780ed21c27e4de162f0d9ac"></a>PCILIB_REGISTER_BITS&#160;</td><td class="fielddoc"><p >Besides a big standard register, the register bit-fields may be described by bit registers. </p>
</td></tr>
<tr><td class="fieldname"><a id="aa0464147a2747278f50b0de1764b17a4a5940cbb4559e3a945d8502202ef8690c" name="aa0464147a2747278f50b0de1764b17a4a5940cbb4559e3a945d8502202ef8690c"></a>PCILIB_REGISTER_PROPERTY&#160;</td><td class="fielddoc"><p >A special register bound to a property and gettings/setting it value through it. </p>
</td></tr>
</table>
<div class="fragment"><div class="line"><span class="lineno">   13</span>             {</div>
<div class="line"><span class="lineno">   14</span>    <a class="code hl_enumvalue" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4a4cec83c230e00bff1d734a952b23953f">PCILIB_REGISTER_STANDARD</a> = 0,               </div>
<div class="line"><span class="lineno">   15</span>    <a class="code hl_enumvalue" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4af46c7bd4435f64b53ae56a05599a6658">PCILIB_REGISTER_FIFO</a>,                       </div>
<div class="line"><span class="lineno">   16</span>    <a class="code hl_enumvalue" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4afe7976e5c780ed21c27e4de162f0d9ac">PCILIB_REGISTER_BITS</a>,                       </div>
<div class="line"><span class="lineno">   17</span>    <a class="code hl_enumvalue" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4a5940cbb4559e3a945d8502202ef8690c">PCILIB_REGISTER_PROPERTY</a>                    </div>
<div class="line"><span class="lineno">   18</span>} <a class="code hl_enumeration" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4">pcilib_register_type_t</a>;</div>
<div class="ttc" id="aregister_8h_html_aa0464147a2747278f50b0de1764b17a4"><div class="ttname"><a href="register_8h.html#aa0464147a2747278f50b0de1764b17a4">pcilib_register_type_t</a></div><div class="ttdeci">pcilib_register_type_t</div><div class="ttdef"><b>Definition:</b> register.h:13</div></div>
<div class="ttc" id="aregister_8h_html_aa0464147a2747278f50b0de1764b17a4a4cec83c230e00bff1d734a952b23953f"><div class="ttname"><a href="register_8h.html#aa0464147a2747278f50b0de1764b17a4a4cec83c230e00bff1d734a952b23953f">PCILIB_REGISTER_STANDARD</a></div><div class="ttdeci">@ PCILIB_REGISTER_STANDARD</div><div class="ttdoc">Standard register.</div><div class="ttdef"><b>Definition:</b> register.h:14</div></div>
<div class="ttc" id="aregister_8h_html_aa0464147a2747278f50b0de1764b17a4a5940cbb4559e3a945d8502202ef8690c"><div class="ttname"><a href="register_8h.html#aa0464147a2747278f50b0de1764b17a4a5940cbb4559e3a945d8502202ef8690c">PCILIB_REGISTER_PROPERTY</a></div><div class="ttdeci">@ PCILIB_REGISTER_PROPERTY</div><div class="ttdoc">A special register bound to a property and gettings/setting it value through it.</div><div class="ttdef"><b>Definition:</b> register.h:17</div></div>
<div class="ttc" id="aregister_8h_html_aa0464147a2747278f50b0de1764b17a4af46c7bd4435f64b53ae56a05599a6658"><div class="ttname"><a href="register_8h.html#aa0464147a2747278f50b0de1764b17a4af46c7bd4435f64b53ae56a05599a6658">PCILIB_REGISTER_FIFO</a></div><div class="ttdeci">@ PCILIB_REGISTER_FIFO</div><div class="ttdoc">FIFO register.</div><div class="ttdef"><b>Definition:</b> register.h:15</div></div>
<div class="ttc" id="aregister_8h_html_aa0464147a2747278f50b0de1764b17a4afe7976e5c780ed21c27e4de162f0d9ac"><div class="ttname"><a href="register_8h.html#aa0464147a2747278f50b0de1764b17a4afe7976e5c780ed21c27e4de162f0d9ac">PCILIB_REGISTER_BITS</a></div><div class="ttdeci">@ PCILIB_REGISTER_BITS</div><div class="ttdoc">Besides a big standard register, the register bit-fields may be described by bit registers.</div><div class="ttdef"><b>Definition:</b> register.h:16</div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aec9a0672eddac26362760345cea77508" name="aec9a0672eddac26362760345cea77508"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec9a0672eddac26362760345cea77508">&#9670;&#160;</a></span>pcilib_add_registers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_add_registers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bank_8h.html#ab2b604364494c4bb061e3c8ff75b3565">pcilib_model_modification_flags_t</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpcilib__register__description__t.html">pcilib_register_description_t</a> *&#160;</td>
          <td class="paramname"><em>registers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcilib_8h.html#a64d66d93f7c4755e67c113b370f982d0">pcilib_register_t</a> *&#160;</td>
          <td class="paramname"><em>ids</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use this function to add new registers into the model. </p>
<p >Currently, it is considered a error to re-add already defined register. If it will turn out to be useful to redefine some registers from the model, it may change in the future. However, we should think how to treat bit-registers in this case. The function will copy the context of registers structure, but name, description, and other strings in the structure are considered to have static duration and will not be copied. On error no new registers are initalized. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">flags</td><td>- not used now, but in future may instruct if existing registers should be reported as error (default), overriden or ignored </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>- number of registers to initialize. It is OK to pass 0 if registers array is NULL terminated (last member of the array have all members set to 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">registers</td><td>- register descriptions </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ids</td><td>- if specified will contain the ids of the newly registered and overriden registers </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   25</span>                                                                                                                                                                   {</div>
<div class="line"><span class="lineno">   26</span>        <span class="comment">// DS: Overrride existing registers </span></div>
<div class="line"><span class="lineno">   27</span>        <span class="comment">// Registers identified by addr + offset + size + type or name</span></div>
<div class="line"><span class="lineno">   28</span>    <span class="keywordtype">int</span> err;</div>
<div class="line"><span class="lineno">   29</span>    <span class="keywordtype">size_t</span> size;</div>
<div class="line"><span class="lineno">   30</span>    <a class="code hl_typedef" href="pcilib_8h.html#a64d66d93f7c4755e67c113b370f982d0">pcilib_register_t</a> i;</div>
<div class="line"><span class="lineno">   31</span> </div>
<div class="line"><span class="lineno">   32</span>    <a class="code hl_struct" href="structpcilib__register__description__t.html">pcilib_register_description_t</a> *regs;</div>
<div class="line"><span class="lineno">   33</span>    <a class="code hl_struct" href="structpcilib__register__context__t.html">pcilib_register_context_t</a> *reg_ctx;</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_typedef" href="bank_8h.html#a7dc74dfb74b49fc1c80cc5459493bee8">pcilib_register_bank_t</a> bank = <a class="code hl_define" href="bank_8h.html#a1e23eec89ad5ac7e79a21ac008719cc4">PCILIB_REGISTER_BANK_INVALID</a>;</div>
<div class="line"><span class="lineno">   36</span>    <a class="code hl_typedef" href="bank_8h.html#a7f3dcbb4f48be84815251627b025785a">pcilib_register_bank_addr_t</a> bank_addr = (<a class="code hl_typedef" href="bank_8h.html#a7f3dcbb4f48be84815251627b025785a">pcilib_register_bank_addr_t</a>)-1;</div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_typedef" href="bank_8h.html#a7dc74dfb74b49fc1c80cc5459493bee8">pcilib_register_bank_t</a> *banks;</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">if</span> (!n) {</div>
<div class="line"><span class="lineno">   40</span>        <span class="keywordflow">for</span> (n = 0; registers[n].<a class="code hl_variable" href="structpcilib__register__description__t.html#a06a84130567982bbcb9ed3372c346830">bits</a>; n++);</div>
<div class="line"><span class="lineno">   41</span>    }</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">if</span> ((ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> + n + 1) &gt; ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">alloc_reg</a>) {</div>
<div class="line"><span class="lineno">   44</span>        <span class="keywordflow">for</span> (size = ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">alloc_reg</a>; size &lt; 2 * (n + ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> + 1); size&lt;&lt;=1);</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>        regs = (<a class="code hl_struct" href="structpcilib__register__description__t.html">pcilib_register_description_t</a>*)realloc(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">registers</a>, size * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__register__description__t.html">pcilib_register_description_t</a>));</div>
<div class="line"><span class="lineno">   47</span>        <span class="keywordflow">if</span> (!regs) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">registers</a> = regs;</div>
<div class="line"><span class="lineno">   50</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#ab08f82dd5bf659b498f798b1078fdf98">model_info</a>.<a class="code hl_variable" href="structpcilib__model__description__t.html#ab11f8776e3e8bb3e0a1fc50a5abf3a70">registers</a> = regs;</div>
<div class="line"><span class="lineno">   51</span> </div>
<div class="line"><span class="lineno">   52</span>        reg_ctx = (<a class="code hl_struct" href="structpcilib__register__context__t.html">pcilib_register_context_t</a>*)realloc(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">registers</a>, size * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__register__context__t.html">pcilib_register_context_t</a>));</div>
<div class="line"><span class="lineno">   53</span>        <span class="keywordflow">if</span> (!reg_ctx) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">   54</span>        </div>
<div class="line"><span class="lineno">   55</span>        memset(reg_ctx + ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">alloc_reg</a>, 0, (size - ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">alloc_reg</a>) * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__register__context__t.html">pcilib_register_context_t</a>));</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>        <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">register_ctx</a> != reg_ctx) {</div>
<div class="line"><span class="lineno">   58</span>                <span class="comment">// We need to recreate cache if context is moved...</span></div>
<div class="line"><span class="lineno">   59</span>            HASH_CLEAR(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">reg_hash</a>);</div>
<div class="line"><span class="lineno">   60</span>            <span class="keywordflow">for</span> (i = 0; i &lt; ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a>; i++) {</div>
<div class="line"><span class="lineno">   61</span>                <a class="code hl_struct" href="structpcilib__register__context__t.html">pcilib_register_context_t</a> *cur = &amp;ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">register_ctx</a>[ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> + i];</div>
<div class="line"><span class="lineno">   62</span>                HASH_ADD_KEYPTR(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">reg_hash</a>, cur-&gt;<a class="code hl_variable" href="structpcilib__register__context__t.html#a4e2000385a71c141bcf93b3fa78974e7">name</a>, strlen(cur-&gt;<a class="code hl_variable" href="structpcilib__register__context__t.html#a4e2000385a71c141bcf93b3fa78974e7">name</a>), cur);</div>
<div class="line"><span class="lineno">   63</span>            }</div>
<div class="line"><span class="lineno">   64</span>        }</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">register_ctx</a> = reg_ctx;</div>
<div class="line"><span class="lineno">   67</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">alloc_reg</a> = size;</div>
<div class="line"><span class="lineno">   68</span>    }</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    banks = (<a class="code hl_typedef" href="bank_8h.html#a7dc74dfb74b49fc1c80cc5459493bee8">pcilib_register_bank_t</a>*)alloca(n * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="bank_8h.html#a7dc74dfb74b49fc1c80cc5459493bee8">pcilib_register_bank_t</a>));</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">if</span> (!banks) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno">   74</span>        <span class="keywordflow">if</span> (registers[i].bank != bank_addr) {</div>
<div class="line"><span class="lineno">   75</span>            bank_addr = registers[i].<a class="code hl_variable" href="structpcilib__register__description__t.html#a011906c1de5a8f7e43ee8d8df435d79f">bank</a>;</div>
<div class="line"><span class="lineno">   76</span>            bank = <a class="code hl_function" href="bank_8c.html#ae9929ece9a387bddb8e3b57bfcbcac92">pcilib_find_register_bank_by_addr</a>(ctx, bank_addr);</div>
<div class="line"><span class="lineno">   77</span>            <span class="keywordflow">if</span> (bank == <a class="code hl_define" href="bank_8h.html#a1e23eec89ad5ac7e79a21ac008719cc4">PCILIB_REGISTER_BANK_INVALID</a>) {</div>
<div class="line"><span class="lineno">   78</span>                    <span class="comment">// We need to add a bank first in this case</span></div>
<div class="line"><span class="lineno">   79</span>                <span class="keywordflow">if</span> (registers[i].type == <a class="code hl_enumvalue" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4a5940cbb4559e3a945d8502202ef8690c">PCILIB_REGISTER_PROPERTY</a>) {</div>
<div class="line"><span class="lineno">   80</span>                    err = <a class="code hl_function" href="bank_8c.html#a1222fd326a61501597298c3e7e18ae5c">pcilib_add_register_banks</a>(ctx, 0, 1, &amp;<a class="code hl_variable" href="export_8c.html#abebbb89db16140394f8ea892e2c71115">pcilib_property_register_bank</a>, &amp;bank);</div>
<div class="line"><span class="lineno">   81</span>                } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   82</span>                    err = <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca9a217d79d35fe9382b46f9f536a6622f">PCILIB_ERROR_INVALID_BANK</a>;</div>
<div class="line"><span class="lineno">   83</span>                }</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>                <span class="keywordflow">if</span> (err) {</div>
<div class="line"><span class="lineno">   86</span>                    <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Invalid bank address (0x%lx) is specified for register %s&quot;</span>, bank_addr, registers[i].name);</div>
<div class="line"><span class="lineno">   87</span>                    <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">   88</span>                }</div>
<div class="line"><span class="lineno">   89</span>            }</div>
<div class="line"><span class="lineno">   90</span>        }</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span><span class="comment">/*</span></div>
<div class="line"><span class="lineno">   93</span><span class="comment">            // No hash so far, will iterate.</span></div>
<div class="line"><span class="lineno">   94</span><span class="comment">        pcilib_register_t reg = pcilib_find_register(ctx, ctx-&gt;banks[bank].name, registers[i].name);</span></div>
<div class="line"><span class="lineno">   95</span><span class="comment">        if (reg != PCILIB_REGISTER_INVALID) {</span></div>
<div class="line"><span class="lineno">   96</span><span class="comment">            pcilib_error(&quot;Register %s is already defined in the model&quot;, registers[i].name);</span></div>
<div class="line"><span class="lineno">   97</span><span class="comment">            return PCILIB_ERROR_EXIST;</span></div>
<div class="line"><span class="lineno">   98</span><span class="comment">        }</span></div>
<div class="line"><span class="lineno">   99</span><span class="comment">*/</span></div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>        banks[i] = bank;</div>
<div class="line"><span class="lineno">  102</span>    }</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    err = <a class="code hl_function" href="property_8c.html#affb1453cac52761dde03f6c56f210f28">pcilib_add_properties_from_registers</a>(ctx, n, banks, registers);</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">if</span> (err) <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno">  108</span>        <a class="code hl_struct" href="structpcilib__register__context__t.html">pcilib_register_context_t</a> *cur = &amp;ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">register_ctx</a>[ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> + i];</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>        cur-&gt;<a class="code hl_variable" href="structpcilib__register__context__t.html#aa4a4dd7e04ea35b079f2eb370729aa9a">reg</a> = ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> + i;</div>
<div class="line"><span class="lineno">  111</span>        cur-&gt;<a class="code hl_variable" href="structpcilib__register__context__t.html#a4e2000385a71c141bcf93b3fa78974e7">name</a> = registers[i].<a class="code hl_variable" href="structpcilib__register__description__t.html#aff7027d4c2f6df0b8471e760843db39d">name</a>;</div>
<div class="line"><span class="lineno">  112</span>        cur-&gt;<a class="code hl_variable" href="structpcilib__register__context__t.html#a628f32e2b6a77a47f689683b01906baf">bank</a> = banks[i];</div>
<div class="line"><span class="lineno">  113</span>        HASH_ADD_KEYPTR(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">reg_hash</a>, cur-&gt;<a class="code hl_variable" href="structpcilib__register__context__t.html#a4e2000385a71c141bcf93b3fa78974e7">name</a>, strlen(cur-&gt;<a class="code hl_variable" href="structpcilib__register__context__t.html#a4e2000385a71c141bcf93b3fa78974e7">name</a>), cur);</div>
<div class="line"><span class="lineno">  114</span>    }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>    memcpy(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">registers</a> + ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a>, registers, n * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__register__description__t.html">pcilib_register_description_t</a>));</div>
<div class="line"><span class="lineno">  117</span>    memset(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">registers</a> + ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> + n, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__register__description__t.html">pcilib_register_description_t</a>));</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordflow">if</span> (ids) {</div>
<div class="line"><span class="lineno">  120</span>        <span class="keywordtype">size_t</span> i;</div>
<div class="line"><span class="lineno">  121</span>        </div>
<div class="line"><span class="lineno">  122</span>        <span class="keywordflow">for</span> (i = 0; i &lt; n; i++)</div>
<div class="line"><span class="lineno">  123</span>            ids[i] = ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> + i;</div>
<div class="line"><span class="lineno">  124</span>    }</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>    ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> += n;</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  129</span>}</div>
<div class="ttc" id="abank_8c_html_a1222fd326a61501597298c3e7e18ae5c"><div class="ttname"><a href="bank_8c.html#a1222fd326a61501597298c3e7e18ae5c">pcilib_add_register_banks</a></div><div class="ttdeci">int pcilib_add_register_banks(pcilib_t *ctx, pcilib_model_modification_flags_t flags, size_t n, const pcilib_register_bank_description_t *banks, pcilib_register_bank_t *ids)</div><div class="ttdoc">Use this function to add new register banks into the model or override configuration of the existing ...</div><div class="ttdef"><b>Definition:</b> bank.c:84</div></div>
<div class="ttc" id="abank_8c_html_ae9929ece9a387bddb8e3b57bfcbcac92"><div class="ttname"><a href="bank_8c.html#ae9929ece9a387bddb8e3b57bfcbcac92">pcilib_find_register_bank_by_addr</a></div><div class="ttdeci">pcilib_register_bank_t pcilib_find_register_bank_by_addr(pcilib_t *ctx, pcilib_register_bank_addr_t bank)</div><div class="ttdoc">Find the register bank id (offset in banks array) corresponding to the specified bank address.</div><div class="ttdef"><b>Definition:</b> bank.c:176</div></div>
<div class="ttc" id="abank_8h_html_a1e23eec89ad5ac7e79a21ac008719cc4"><div class="ttname"><a href="bank_8h.html#a1e23eec89ad5ac7e79a21ac008719cc4">PCILIB_REGISTER_BANK_INVALID</a></div><div class="ttdeci">#define PCILIB_REGISTER_BANK_INVALID</div><div class="ttdef"><b>Definition:</b> bank.h:6</div></div>
<div class="ttc" id="abank_8h_html_a7dc74dfb74b49fc1c80cc5459493bee8"><div class="ttname"><a href="bank_8h.html#a7dc74dfb74b49fc1c80cc5459493bee8">pcilib_register_bank_t</a></div><div class="ttdeci">uint8_t pcilib_register_bank_t</div><div class="ttdoc">Type holding the bank position within the field listing register banks in the model.</div><div class="ttdef"><b>Definition:</b> bank.h:28</div></div>
<div class="ttc" id="abank_8h_html_a7f3dcbb4f48be84815251627b025785a"><div class="ttname"><a href="bank_8h.html#a7f3dcbb4f48be84815251627b025785a">pcilib_register_bank_addr_t</a></div><div class="ttdeci">uint8_t pcilib_register_bank_addr_t</div><div class="ttdoc">Type holding the bank address number.</div><div class="ttdef"><b>Definition:</b> bank.h:29</div></div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60ca9a217d79d35fe9382b46f9f536a6622f"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca9a217d79d35fe9382b46f9f536a6622f">PCILIB_ERROR_INVALID_BANK</a></div><div class="ttdeci">@ PCILIB_ERROR_INVALID_BANK</div><div class="ttdef"><b>Definition:</b> error.h:17</div></div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a></div><div class="ttdeci">@ PCILIB_ERROR_MEMORY</div><div class="ttdef"><b>Definition:</b> error.h:14</div></div>
<div class="ttc" id="aerror_8h_html_a2b06064fecffd095efabb752f7b50021"><div class="ttname"><a href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a></div><div class="ttdeci">#define pcilib_error(...)</div><div class="ttdef"><b>Definition:</b> error.h:68</div></div>
<div class="ttc" id="aexport_8c_html_abebbb89db16140394f8ea892e2c71115"><div class="ttname"><a href="export_8c.html#abebbb89db16140394f8ea892e2c71115">pcilib_property_register_bank</a></div><div class="ttdeci">const pcilib_register_bank_description_t pcilib_property_register_bank</div><div class="ttdef"><b>Definition:</b> export.c:34</div></div>
<div class="ttc" id="apcilib_8h_html_a64d66d93f7c4755e67c113b370f982d0"><div class="ttname"><a href="pcilib_8h.html#a64d66d93f7c4755e67c113b370f982d0">pcilib_register_t</a></div><div class="ttdeci">uint16_t pcilib_register_t</div><div class="ttdoc">Type holding the register position within the field listing registers in the model.</div><div class="ttdef"><b>Definition:</b> pcilib.h:15</div></div>
<div class="ttc" id="aproperty_8c_html_affb1453cac52761dde03f6c56f210f28"><div class="ttname"><a href="property_8c.html#affb1453cac52761dde03f6c56f210f28">pcilib_add_properties_from_registers</a></div><div class="ttdeci">int pcilib_add_properties_from_registers(pcilib_t *ctx, size_t n, const pcilib_register_bank_t *banks, const pcilib_register_description_t *registers)</div><div class="ttdoc">This is an internal function used to add property views for all model registers.</div><div class="ttdef"><b>Definition:</b> property.c:61</div></div>
<div class="ttc" id="astructpcilib__model__description__t_html_ab11f8776e3e8bb3e0a1fc50a5abf3a70"><div class="ttname"><a href="structpcilib__model__description__t.html#ab11f8776e3e8bb3e0a1fc50a5abf3a70">pcilib_model_description_t::registers</a></div><div class="ttdeci">const pcilib_register_description_t * registers</div><div class="ttdef"><b>Definition:</b> model.h:18</div></div>
<div class="ttc" id="astructpcilib__register__context__t_html"><div class="ttname"><a href="structpcilib__register__context__t.html">pcilib_register_context_t</a></div><div class="ttdef"><b>Definition:</b> register.h:46</div></div>
<div class="ttc" id="astructpcilib__register__context__t_html_a4e2000385a71c141bcf93b3fa78974e7"><div class="ttname"><a href="structpcilib__register__context__t.html#a4e2000385a71c141bcf93b3fa78974e7">pcilib_register_context_t::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">Register name.</div><div class="ttdef"><b>Definition:</b> register.h:47</div></div>
<div class="ttc" id="astructpcilib__register__context__t_html_a628f32e2b6a77a47f689683b01906baf"><div class="ttname"><a href="structpcilib__register__context__t.html#a628f32e2b6a77a47f689683b01906baf">pcilib_register_context_t::bank</a></div><div class="ttdeci">pcilib_register_bank_t bank</div><div class="ttdoc">Reference to bank containing the register.</div><div class="ttdef"><b>Definition:</b> register.h:49</div></div>
<div class="ttc" id="astructpcilib__register__context__t_html_aa4a4dd7e04ea35b079f2eb370729aa9a"><div class="ttname"><a href="structpcilib__register__context__t.html#aa4a4dd7e04ea35b079f2eb370729aa9a">pcilib_register_context_t::reg</a></div><div class="ttdeci">pcilib_register_t reg</div><div class="ttdoc">Register index.</div><div class="ttdef"><b>Definition:</b> register.h:48</div></div>
<div class="ttc" id="astructpcilib__register__description__t_html"><div class="ttname"><a href="structpcilib__register__description__t.html">pcilib_register_description_t</a></div><div class="ttdef"><b>Definition:</b> register.h:25</div></div>
<div class="ttc" id="astructpcilib__register__description__t_html_a011906c1de5a8f7e43ee8d8df435d79f"><div class="ttname"><a href="structpcilib__register__description__t.html#a011906c1de5a8f7e43ee8d8df435d79f">pcilib_register_description_t::bank</a></div><div class="ttdeci">pcilib_register_bank_addr_t bank</div><div class="ttdoc">Specified the address of the bank this register belongs to.</div><div class="ttdef"><b>Definition:</b> register.h:38</div></div>
<div class="ttc" id="astructpcilib__register__description__t_html_a06a84130567982bbcb9ed3372c346830"><div class="ttname"><a href="structpcilib__register__description__t.html#a06a84130567982bbcb9ed3372c346830">pcilib_register_description_t::bits</a></div><div class="ttdeci">pcilib_register_size_t bits</div><div class="ttdoc">Register size in bits.</div><div class="ttdef"><b>Definition:</b> register.h:28</div></div>
<div class="ttc" id="astructpcilib__register__description__t_html_aff7027d4c2f6df0b8471e760843db39d"><div class="ttname"><a href="structpcilib__register__description__t.html#aff7027d4c2f6df0b8471e760843db39d">pcilib_register_description_t::name</a></div><div class="ttdeci">const char * name</div><div class="ttdoc">The access name of the register.</div><div class="ttdef"><b>Definition:</b> register.h:40</div></div>
<div class="ttc" id="astructpcilib__s_html_a4b24f857efec07c254d2fa2226b59fda"><div class="ttname"><a href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">pcilib_s::register_ctx</a></div><div class="ttdeci">pcilib_register_context_t * register_ctx</div><div class="ttdoc">Contexts for registers.</div><div class="ttdef"><b>Definition:</b> pci.h:87</div></div>
<div class="ttc" id="astructpcilib__s_html_a5d3c8e44d590052b9112526e61b3e64b"><div class="ttname"><a href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">pcilib_s::num_reg</a></div><div class="ttdeci">size_t num_reg</div><div class="ttdef"><b>Definition:</b> pci.h:76</div></div>
<div class="ttc" id="astructpcilib__s_html_a8c3ebd9b2e22105970a21d4f8b7564db"><div class="ttname"><a href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">pcilib_s::alloc_reg</a></div><div class="ttdeci">size_t alloc_reg</div><div class="ttdoc">Number of registered and allocated registers.</div><div class="ttdef"><b>Definition:</b> pci.h:76</div></div>
<div class="ttc" id="astructpcilib__s_html_a99e18f8f358339d97d49076994159d48"><div class="ttname"><a href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">pcilib_s::reg_hash</a></div><div class="ttdeci">pcilib_register_context_t * reg_hash</div><div class="ttdoc">Hash of registers.</div><div class="ttdef"><b>Definition:</b> pci.h:99</div></div>
<div class="ttc" id="astructpcilib__s_html_a9f6bc50561128b6e7f78296f23db134a"><div class="ttname"><a href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">pcilib_s::registers</a></div><div class="ttdeci">pcilib_register_description_t * registers</div><div class="ttdoc">List of currently defined registers (from all sources)</div><div class="ttdef"><b>Definition:</b> pci.h:80</div></div>
<div class="ttc" id="astructpcilib__s_html_ab08f82dd5bf659b498f798b1078fdf98"><div class="ttname"><a href="structpcilib__s.html#ab08f82dd5bf659b498f798b1078fdf98">pcilib_s::model_info</a></div><div class="ttdeci">pcilib_model_description_t model_info</div><div class="ttdoc">Current model description combined from the information returned by the event plugin and all dynamic ...</div><div class="ttdef"><b>Definition:</b> pci.h:73</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">pcilib_s::alloc_reg</a>, <a class="el" href="structpcilib__register__description__t.html#a011906c1de5a8f7e43ee8d8df435d79f">pcilib_register_description_t::bank</a>, <a class="el" href="structpcilib__register__context__t.html#a628f32e2b6a77a47f689683b01906baf">pcilib_register_context_t::bank</a>, <a class="el" href="structpcilib__register__description__t.html#a06a84130567982bbcb9ed3372c346830">pcilib_register_description_t::bits</a>, <a class="el" href="structpcilib__s.html#ab08f82dd5bf659b498f798b1078fdf98">pcilib_s::model_info</a>, <a class="el" href="structpcilib__register__description__t.html#aff7027d4c2f6df0b8471e760843db39d">pcilib_register_description_t::name</a>, <a class="el" href="structpcilib__register__context__t.html#a4e2000385a71c141bcf93b3fa78974e7">pcilib_register_context_t::name</a>, <a class="el" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">pcilib_s::num_reg</a>, <a class="el" href="property_8c.html#affb1453cac52761dde03f6c56f210f28">pcilib_add_properties_from_registers()</a>, <a class="el" href="bank_8c.html#a1222fd326a61501597298c3e7e18ae5c">pcilib_add_register_banks()</a>, <a class="el" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca9a217d79d35fe9382b46f9f536a6622f">PCILIB_ERROR_INVALID_BANK</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>, <a class="el" href="bank_8c.html#ae9929ece9a387bddb8e3b57bfcbcac92">pcilib_find_register_bank_by_addr()</a>, <a class="el" href="export_8c.html#abebbb89db16140394f8ea892e2c71115">pcilib_property_register_bank</a>, <a class="el" href="bank_8h.html#a1e23eec89ad5ac7e79a21ac008719cc4">PCILIB_REGISTER_BANK_INVALID</a>, <a class="el" href="register_8h.html#aa0464147a2747278f50b0de1764b17a4a5940cbb4559e3a945d8502202ef8690c">PCILIB_REGISTER_PROPERTY</a>, <a class="el" href="structpcilib__register__context__t.html#aa4a4dd7e04ea35b079f2eb370729aa9a">pcilib_register_context_t::reg</a>, <a class="el" href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">pcilib_s::reg_hash</a>, <a class="el" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">pcilib_s::register_ctx</a>, <a class="el" href="structpcilib__model__description__t.html#ab11f8776e3e8bb3e0a1fc50a5abf3a70">pcilib_model_description_t::registers</a>, and <a class="el" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">pcilib_s::registers</a>.</p>

<p class="reference">Referenced by <a class="el" href="property_8c.html#a6f859397a4f272589f043f72822419f2">pcilib_add_registers_from_properties()</a>, and <a class="el" href="group__public__api.html#gaa6d33dcd1de77fa87c66276653c164a0">pcilib_open()</a>.</p>

</div>
</div>
<a id="a4fadb52b2487bc1196be90a9bcf09fdc" name="a4fadb52b2487bc1196be90a9bcf09fdc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4fadb52b2487bc1196be90a9bcf09fdc">&#9670;&#160;</a></span>pcilib_clean_registers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pcilib_clean_registers </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcilib_8h.html#a64d66d93f7c4755e67c113b370f982d0">pcilib_register_t</a>&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys data associated with registers. </p>
<p >This is an internal function and will be called during clean-up. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">start</td><td>- specifies first register to clean (used to clean only part of the registers to keep the defined state if pcilib_add_registers has failed) </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">  131</span>                                                                    {</div>
<div class="line"><span class="lineno">  132</span>    <a class="code hl_typedef" href="pcilib_8h.html#a64d66d93f7c4755e67c113b370f982d0">pcilib_register_t</a> reg;</div>
<div class="line"><span class="lineno">  133</span>    <a class="code hl_struct" href="structpcilib__register__context__t.html">pcilib_register_context_t</a> *reg_ctx, *tmp;</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">if</span> (start) {</div>
<div class="line"><span class="lineno">  136</span>        HASH_ITER(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">reg_hash</a>, reg_ctx, tmp) {</div>
<div class="line"><span class="lineno">  137</span>            <span class="keywordflow">if</span> (reg_ctx-&gt;<a class="code hl_variable" href="structpcilib__register__context__t.html#aa4a4dd7e04ea35b079f2eb370729aa9a">reg</a> &gt;= start) {</div>
<div class="line"><span class="lineno">  138</span>                HASH_DEL(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">reg_hash</a>, reg_ctx);</div>
<div class="line"><span class="lineno">  139</span>            }</div>
<div class="line"><span class="lineno">  140</span>        }</div>
<div class="line"><span class="lineno">  141</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  142</span>        HASH_CLEAR(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">reg_hash</a>);</div>
<div class="line"><span class="lineno">  143</span>    }</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <span class="keywordflow">for</span> (reg = start; reg &lt; ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a>; reg++) {</div>
<div class="line"><span class="lineno">  146</span>        <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">register_ctx</a>[reg].<a class="code hl_variable" href="structpcilib__register__context__t.html#a25774338e62cf58d42d3fc09a8362010">views</a>)</div>
<div class="line"><span class="lineno">  147</span>            free(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">register_ctx</a>[reg].<a class="code hl_variable" href="structpcilib__register__context__t.html#a25774338e62cf58d42d3fc09a8362010">views</a>);</div>
<div class="line"><span class="lineno">  148</span>    }</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">registers</a>)</div>
<div class="line"><span class="lineno">  151</span>        memset(&amp;ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">registers</a>[start], 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__register__description__t.html">pcilib_register_description_t</a>));</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">register_ctx</a>)</div>
<div class="line"><span class="lineno">  154</span>        memset(&amp;ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">register_ctx</a>[start], 0, (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">alloc_reg</a> - start) * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__register__context__t.html">pcilib_register_context_t</a>));</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>    ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">num_reg</a> = start;</div>
<div class="line"><span class="lineno">  157</span>}</div>
<div class="ttc" id="astructpcilib__register__context__t_html_a25774338e62cf58d42d3fc09a8362010"><div class="ttname"><a href="structpcilib__register__context__t.html#a25774338e62cf58d42d3fc09a8362010">pcilib_register_context_t::views</a></div><div class="ttdeci">pcilib_view_reference_t * views</div><div class="ttdoc">For non-static list of views, this vairables holds a copy of a NULL-terminated list from model (if pr...</div><div class="ttdef"><b>Definition:</b> register.h:52</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structpcilib__s.html#a8c3ebd9b2e22105970a21d4f8b7564db">pcilib_s::alloc_reg</a>, <a class="el" href="structpcilib__s.html#a5d3c8e44d590052b9112526e61b3e64b">pcilib_s::num_reg</a>, <a class="el" href="structpcilib__register__context__t.html#aa4a4dd7e04ea35b079f2eb370729aa9a">pcilib_register_context_t::reg</a>, <a class="el" href="structpcilib__s.html#a99e18f8f358339d97d49076994159d48">pcilib_s::reg_hash</a>, <a class="el" href="structpcilib__s.html#a4b24f857efec07c254d2fa2226b59fda">pcilib_s::register_ctx</a>, <a class="el" href="structpcilib__s.html#a9f6bc50561128b6e7f78296f23db134a">pcilib_s::registers</a>, and <a class="el" href="structpcilib__register__context__t.html#a25774338e62cf58d42d3fc09a8362010">pcilib_register_context_t::views</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__public__api.html#ga809b61586ed9c56a7510c607859e75e3">pcilib_close()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 18 2024 22:02:48 for pcilib by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
