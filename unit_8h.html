<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>pcilib: unit.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">pcilib
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_0b5c8f32f3013e7b96dc99509907414c.html">pcilib</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">unit.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;uthash.h&gt;</code><br />
<code>#include &lt;<a class="el" href="pcilib_8h_source.html">pcilib.h</a>&gt;</code><br />
</div>
<p><a href="unit_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">unit transformation routines  <a href="structpcilib__unit__transform__t.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpcilib__unit__context__s.html">pcilib_unit_context_s</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a55a044c7ba9ccbc6957623c8571e2eb8"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#a55a044c7ba9ccbc6957623c8571e2eb8">PCILIB_UNIT_INVALID</a>&#160;&#160;&#160;((<a class="el" href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a>)-1)</td></tr>
<tr class="separator:a55a044c7ba9ccbc6957623c8571e2eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30376a37c91ab2fda5ce9f9aeb6095e2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#a30376a37c91ab2fda5ce9f9aeb6095e2">PCILIB_UNIT_TRANSFORM_INVALID</a>&#160;&#160;&#160;((<a class="el" href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a>)-1)</td></tr>
<tr class="separator:a30376a37c91ab2fda5ce9f9aeb6095e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87d96e76f4903cfb56455d7800757f2b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#a87d96e76f4903cfb56455d7800757f2b">PCILIB_MAX_TRANSFORMS_PER_UNIT</a>&#160;&#160;&#160;16</td></tr>
<tr class="memdesc:a87d96e76f4903cfb56455d7800757f2b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Limits number of supported transforms per unit.  <a href="unit_8h.html#a87d96e76f4903cfb56455d7800757f2b">More...</a><br /></td></tr>
<tr class="separator:a87d96e76f4903cfb56455d7800757f2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a45977f7fa652aaeff142f0d2a0effb01"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structpcilib__unit__context__s.html">pcilib_unit_context_s</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#a45977f7fa652aaeff142f0d2a0effb01">pcilib_unit_context_t</a></td></tr>
<tr class="separator:a45977f7fa652aaeff142f0d2a0effb01"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9b63096e73a5e91bf520dba108cdd41b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#a9b63096e73a5e91bf520dba108cdd41b">pcilib_add_units</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, size_t n, const <a class="el" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a> *desc)</td></tr>
<tr class="memdesc:a9b63096e73a5e91bf520dba108cdd41b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Use this function to add new unit definitions into the model.  <a href="unit_8h.html#a9b63096e73a5e91bf520dba108cdd41b">More...</a><br /></td></tr>
<tr class="separator:a9b63096e73a5e91bf520dba108cdd41b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6d4f7a96df89f7a429e64886754e2cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#ac6d4f7a96df89f7a429e64886754e2cc">pcilib_clean_units</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, <a class="el" href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a> start)</td></tr>
<tr class="memdesc:ac6d4f7a96df89f7a429e64886754e2cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroys data associated with units.  <a href="unit_8h.html#ac6d4f7a96df89f7a429e64886754e2cc">More...</a><br /></td></tr>
<tr class="separator:ac6d4f7a96df89f7a429e64886754e2cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa472057642cac1d33d81aa803bc6c5f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#aaa472057642cac1d33d81aa803bc6c5f">pcilib_find_unit_by_name</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const char *unit)</td></tr>
<tr class="memdesc:aaa472057642cac1d33d81aa803bc6c5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find unit id using supplied name.  <a href="unit_8h.html#aaa472057642cac1d33d81aa803bc6c5f">More...</a><br /></td></tr>
<tr class="separator:aaa472057642cac1d33d81aa803bc6c5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5c8796359ba5bf8917221db1db3fc75"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#ab5c8796359ba5bf8917221db1db3fc75">pcilib_find_transform_by_unit_names</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const char *from, const char *to)</td></tr>
<tr class="memdesc:ab5c8796359ba5bf8917221db1db3fc75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find the required transform between two specified units.  <a href="unit_8h.html#ab5c8796359ba5bf8917221db1db3fc75">More...</a><br /></td></tr>
<tr class="separator:ab5c8796359ba5bf8917221db1db3fc75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95f01e52d74bdb197b8c37466f854263"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#a95f01e52d74bdb197b8c37466f854263">pcilib_transform_unit</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const <a class="el" href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a> *trans, <a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *value)</td></tr>
<tr class="memdesc:a95f01e52d74bdb197b8c37466f854263"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts value to the requested units.  <a href="unit_8h.html#a95f01e52d74bdb197b8c37466f854263">More...</a><br /></td></tr>
<tr class="separator:a95f01e52d74bdb197b8c37466f854263"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ba0687e6afff19be2628811c6220e90"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="unit_8h.html#a3ba0687e6afff19be2628811c6220e90">pcilib_transform_unit_by_name</a> (<a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *ctx, const char *to, <a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *value)</td></tr>
<tr class="memdesc:a3ba0687e6afff19be2628811c6220e90"><td class="mdescLeft">&#160;</td><td class="mdescRight">Converts value to the requested units.  <a href="unit_8h.html#a3ba0687e6afff19be2628811c6220e90">More...</a><br /></td></tr>
<tr class="separator:a3ba0687e6afff19be2628811c6220e90"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a87d96e76f4903cfb56455d7800757f2b" name="a87d96e76f4903cfb56455d7800757f2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87d96e76f4903cfb56455d7800757f2b">&#9670;&#160;</a></span>PCILIB_MAX_TRANSFORMS_PER_UNIT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PCILIB_MAX_TRANSFORMS_PER_UNIT&#160;&#160;&#160;16</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Limits number of supported transforms per unit. </p>

</div>
</div>
<a id="a55a044c7ba9ccbc6957623c8571e2eb8" name="a55a044c7ba9ccbc6957623c8571e2eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55a044c7ba9ccbc6957623c8571e2eb8">&#9670;&#160;</a></span>PCILIB_UNIT_INVALID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PCILIB_UNIT_INVALID&#160;&#160;&#160;((<a class="el" href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a>)-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a30376a37c91ab2fda5ce9f9aeb6095e2" name="a30376a37c91ab2fda5ce9f9aeb6095e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30376a37c91ab2fda5ce9f9aeb6095e2">&#9670;&#160;</a></span>PCILIB_UNIT_TRANSFORM_INVALID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PCILIB_UNIT_TRANSFORM_INVALID&#160;&#160;&#160;((<a class="el" href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a>)-1)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a45977f7fa652aaeff142f0d2a0effb01" name="a45977f7fa652aaeff142f0d2a0effb01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a45977f7fa652aaeff142f0d2a0effb01">&#9670;&#160;</a></span>pcilib_unit_context_t</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structpcilib__unit__context__s.html">pcilib_unit_context_s</a> <a class="el" href="unit_8h.html#a45977f7fa652aaeff142f0d2a0effb01">pcilib_unit_context_t</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9b63096e73a5e91bf520dba108cdd41b" name="a9b63096e73a5e91bf520dba108cdd41b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b63096e73a5e91bf520dba108cdd41b">&#9670;&#160;</a></span>pcilib_add_units()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_add_units </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a> *&#160;</td>
          <td class="paramname"><em>desc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Use this function to add new unit definitions into the model. </p>
<p >It is error to re-register already registered unit. The function will copy the context of unit description, but name, transform, and other strings in the structure are considered to have static duration and will not be copied. On error no new units are initalized. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>- number of units to initialize. It is OK to pass 0 if protocols variable is NULL terminated (last member of protocols array have all members set to 0) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">desc</td><td>- unit descriptions </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   13</span>                                                                                     {</div>
<div class="line"><span class="lineno">   14</span>    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><span class="lineno">   15</span>    <span class="keywordtype">int</span> err = 0;</div>
<div class="line"><span class="lineno">   16</span> </div>
<div class="line"><span class="lineno">   17</span>    <span class="keywordflow">if</span> (!n) {</div>
<div class="line"><span class="lineno">   18</span>        <span class="keywordflow">for</span> (n = 0; desc[n].<a class="code hl_variable" href="structpcilib__unit__description__t.html#a1aceefa0125d7df6c0e12a023e30d1a4">name</a>; n++);</div>
<div class="line"><span class="lineno">   19</span>    }</div>
<div class="line"><span class="lineno">   20</span> </div>
<div class="line"><span class="lineno">   21</span>    <span class="keywordflow">if</span> ((ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a> + n + 1) &gt; ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a30e41f6841c2ed17baa317311a5765d5">alloc_units</a>) {</div>
<div class="line"><span class="lineno">   22</span>        <span class="keywordtype">size_t</span> size;</div>
<div class="line"><span class="lineno">   23</span>        <a class="code hl_struct" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a> *units;</div>
<div class="line"><span class="lineno">   24</span> </div>
<div class="line"><span class="lineno">   25</span>        <span class="keywordflow">for</span> (size = ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a30e41f6841c2ed17baa317311a5765d5">alloc_units</a>; size &lt; 2 * (n + ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a> + 1); size &lt;&lt;= 1);</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>        units = (<a class="code hl_struct" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a>*)realloc(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">units</a>, size * <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a>));</div>
<div class="line"><span class="lineno">   28</span>        <span class="keywordflow">if</span> (!units) <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">units</a> = units;</div>
<div class="line"><span class="lineno">   31</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a30e41f6841c2ed17baa317311a5765d5">alloc_units</a> = size;</div>
<div class="line"><span class="lineno">   32</span> </div>
<div class="line"><span class="lineno">   33</span>        ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#ab08f82dd5bf659b498f798b1078fdf98">model_info</a>.<a class="code hl_variable" href="structpcilib__model__description__t.html#a068c972a2e8dcc0294f195dbe5b6c7c3">units</a> = units;</div>
<div class="line"><span class="lineno">   34</span>    }</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>        <span class="comment">// ToDo: Check if exists...</span></div>
<div class="line"><span class="lineno">   37</span>    <span class="keywordflow">for</span> (i = 0; i &lt; n; i++) {</div>
<div class="line"><span class="lineno">   38</span>        <a class="code hl_typedef" href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a> unit = <a class="code hl_function" href="unit_8c.html#acd635e093de3d7d1f5a20e6091c4b950">pcilib_find_unit_by_name</a>(ctx, desc[i].name);</div>
<div class="line"><span class="lineno">   39</span>        <span class="keywordflow">if</span> (unit != <a class="code hl_define" href="unit_8h.html#a55a044c7ba9ccbc6957623c8571e2eb8">PCILIB_UNIT_INVALID</a>) {</div>
<div class="line"><span class="lineno">   40</span>            <a class="code hl_function" href="unit_8c.html#ac6d4f7a96df89f7a429e64886754e2cc">pcilib_clean_units</a>(ctx, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a>);</div>
<div class="line"><span class="lineno">   41</span>            <a class="code hl_define" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>(<span class="stringliteral">&quot;Unit %s is already defined in the model&quot;</span>, desc[i].name);</div>
<div class="line"><span class="lineno">   42</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca480c3c07a5b087945ef9844623f48e9d">PCILIB_ERROR_EXIST</a>;</div>
<div class="line"><span class="lineno">   43</span>        }</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>        <a class="code hl_struct" href="structpcilib__unit__context__s.html">pcilib_unit_context_t</a> *unit_ctx = (<a class="code hl_struct" href="structpcilib__unit__context__s.html">pcilib_unit_context_t</a>*)malloc(<span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__unit__context__s.html">pcilib_unit_context_t</a>));</div>
<div class="line"><span class="lineno">   46</span>        <span class="keywordflow">if</span> (!unit_ctx) {</div>
<div class="line"><span class="lineno">   47</span>            <a class="code hl_function" href="unit_8c.html#ac6d4f7a96df89f7a429e64886754e2cc">pcilib_clean_units</a>(ctx, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a>);</div>
<div class="line"><span class="lineno">   48</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>;</div>
<div class="line"><span class="lineno">   49</span>        }</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>        memset(unit_ctx, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__unit__context__s.html">pcilib_unit_context_t</a>));</div>
<div class="line"><span class="lineno">   52</span>        unit_ctx-&gt;<a class="code hl_variable" href="structpcilib__unit__context__s.html#a006b87c0b6c75a405f8629b70be562ad">unit</a> = ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a> + i;</div>
<div class="line"><span class="lineno">   53</span>        unit_ctx-&gt;<a class="code hl_variable" href="structpcilib__unit__context__s.html#a09d580fe02262bb598356c892d4137bb">name</a> = desc[i].<a class="code hl_variable" href="structpcilib__unit__description__t.html#a1aceefa0125d7df6c0e12a023e30d1a4">name</a>;</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>        HASH_ADD_KEYPTR(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">unit_hash</a>, unit_ctx-&gt;<a class="code hl_variable" href="structpcilib__unit__context__s.html#a09d580fe02262bb598356c892d4137bb">name</a>, strlen(unit_ctx-&gt;<a class="code hl_variable" href="structpcilib__unit__context__s.html#a09d580fe02262bb598356c892d4137bb">name</a>), unit_ctx);</div>
<div class="line"><span class="lineno">   56</span>        memcpy(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">units</a> + ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a> + i, &amp;desc[i], <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a>));</div>
<div class="line"><span class="lineno">   57</span>    }</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>    ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a> += n;</div>
<div class="line"><span class="lineno">   60</span>    memset(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">units</a> + ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a>, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a>));</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">   63</span>}</div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60ca480c3c07a5b087945ef9844623f48e9d"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca480c3c07a5b087945ef9844623f48e9d">PCILIB_ERROR_EXIST</a></div><div class="ttdeci">@ PCILIB_ERROR_EXIST</div><div class="ttdef"><b>Definition:</b> error.h:33</div></div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a></div><div class="ttdeci">@ PCILIB_ERROR_MEMORY</div><div class="ttdef"><b>Definition:</b> error.h:14</div></div>
<div class="ttc" id="aerror_8h_html_a2b06064fecffd095efabb752f7b50021"><div class="ttname"><a href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a></div><div class="ttdeci">#define pcilib_error(...)</div><div class="ttdef"><b>Definition:</b> error.h:68</div></div>
<div class="ttc" id="apcilib_8h_html_ad969fce8a73484aa5f74ba8c125427b8"><div class="ttname"><a href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a></div><div class="ttdeci">uint16_t pcilib_unit_t</div><div class="ttdoc">Type holding the value unit position within unit listing in the model.</div><div class="ttdef"><b>Definition:</b> pcilib.h:17</div></div>
<div class="ttc" id="astructpcilib__model__description__t_html_a068c972a2e8dcc0294f195dbe5b6c7c3"><div class="ttname"><a href="structpcilib__model__description__t.html#a068c972a2e8dcc0294f195dbe5b6c7c3">pcilib_model_description_t::units</a></div><div class="ttdeci">const pcilib_unit_description_t * units</div><div class="ttdef"><b>Definition:</b> model.h:23</div></div>
<div class="ttc" id="astructpcilib__s_html_a05d5ea2f170c18f320ae1ce7d05e378f"><div class="ttname"><a href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">pcilib_s::units</a></div><div class="ttdeci">pcilib_unit_description_t * units</div><div class="ttdoc">list of currently defined units</div><div class="ttdef"><b>Definition:</b> pci.h:95</div></div>
<div class="ttc" id="astructpcilib__s_html_a30e41f6841c2ed17baa317311a5765d5"><div class="ttname"><a href="structpcilib__s.html#a30e41f6841c2ed17baa317311a5765d5">pcilib_s::alloc_units</a></div><div class="ttdeci">size_t alloc_units</div><div class="ttdoc">Number of configured and allocated units.</div><div class="ttdef"><b>Definition:</b> pci.h:93</div></div>
<div class="ttc" id="astructpcilib__s_html_a476d59af0a89bc93b3711a7f35d2632e"><div class="ttname"><a href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">pcilib_s::num_units</a></div><div class="ttdeci">size_t num_units</div><div class="ttdef"><b>Definition:</b> pci.h:93</div></div>
<div class="ttc" id="astructpcilib__s_html_a6726f3274210ed8e3a2afeebac1f10c8"><div class="ttname"><a href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">pcilib_s::unit_hash</a></div><div class="ttdeci">pcilib_unit_context_t * unit_hash</div><div class="ttdoc">Hash of units.</div><div class="ttdef"><b>Definition:</b> pci.h:97</div></div>
<div class="ttc" id="astructpcilib__s_html_ab08f82dd5bf659b498f798b1078fdf98"><div class="ttname"><a href="structpcilib__s.html#ab08f82dd5bf659b498f798b1078fdf98">pcilib_s::model_info</a></div><div class="ttdeci">pcilib_model_description_t model_info</div><div class="ttdoc">Current model description combined from the information returned by the event plugin and all dynamic ...</div><div class="ttdef"><b>Definition:</b> pci.h:73</div></div>
<div class="ttc" id="astructpcilib__unit__context__s_html"><div class="ttname"><a href="structpcilib__unit__context__s.html">pcilib_unit_context_s</a></div><div class="ttdef"><b>Definition:</b> unit.h:28</div></div>
<div class="ttc" id="astructpcilib__unit__context__s_html_a006b87c0b6c75a405f8629b70be562ad"><div class="ttname"><a href="structpcilib__unit__context__s.html#a006b87c0b6c75a405f8629b70be562ad">pcilib_unit_context_s::unit</a></div><div class="ttdeci">pcilib_unit_t unit</div><div class="ttdef"><b>Definition:</b> unit.h:30</div></div>
<div class="ttc" id="astructpcilib__unit__context__s_html_a09d580fe02262bb598356c892d4137bb"><div class="ttname"><a href="structpcilib__unit__context__s.html#a09d580fe02262bb598356c892d4137bb">pcilib_unit_context_s::name</a></div><div class="ttdeci">const char * name</div><div class="ttdef"><b>Definition:</b> unit.h:29</div></div>
<div class="ttc" id="astructpcilib__unit__description__t_html"><div class="ttname"><a href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a></div><div class="ttdef"><b>Definition:</b> unit.h:23</div></div>
<div class="ttc" id="astructpcilib__unit__description__t_html_a1aceefa0125d7df6c0e12a023e30d1a4"><div class="ttname"><a href="structpcilib__unit__description__t.html#a1aceefa0125d7df6c0e12a023e30d1a4">pcilib_unit_description_t::name</a></div><div class="ttdeci">char * name</div><div class="ttdoc">Unit name.</div><div class="ttdef"><b>Definition:</b> unit.h:24</div></div>
<div class="ttc" id="aunit_8c_html_ac6d4f7a96df89f7a429e64886754e2cc"><div class="ttname"><a href="unit_8c.html#ac6d4f7a96df89f7a429e64886754e2cc">pcilib_clean_units</a></div><div class="ttdeci">void pcilib_clean_units(pcilib_t *ctx, pcilib_unit_t start)</div><div class="ttdoc">Destroys data associated with units.</div><div class="ttdef"><b>Definition:</b> unit.c:65</div></div>
<div class="ttc" id="aunit_8c_html_acd635e093de3d7d1f5a20e6091c4b950"><div class="ttname"><a href="unit_8c.html#acd635e093de3d7d1f5a20e6091c4b950">pcilib_find_unit_by_name</a></div><div class="ttdeci">pcilib_unit_t pcilib_find_unit_by_name(pcilib_t *ctx, const char *name)</div><div class="ttdoc">Find unit id using supplied name.</div><div class="ttdef"><b>Definition:</b> unit.c:81</div></div>
<div class="ttc" id="aunit_8h_html_a55a044c7ba9ccbc6957623c8571e2eb8"><div class="ttname"><a href="unit_8h.html#a55a044c7ba9ccbc6957623c8571e2eb8">PCILIB_UNIT_INVALID</a></div><div class="ttdeci">#define PCILIB_UNIT_INVALID</div><div class="ttdef"><b>Definition:</b> unit.h:8</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structpcilib__s.html#a30e41f6841c2ed17baa317311a5765d5">pcilib_s::alloc_units</a>, <a class="el" href="structpcilib__s.html#ab08f82dd5bf659b498f798b1078fdf98">pcilib_s::model_info</a>, <a class="el" href="structpcilib__unit__description__t.html#a1aceefa0125d7df6c0e12a023e30d1a4">pcilib_unit_description_t::name</a>, <a class="el" href="structpcilib__unit__context__s.html#a09d580fe02262bb598356c892d4137bb">pcilib_unit_context_s::name</a>, <a class="el" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">pcilib_s::num_units</a>, <a class="el" href="unit_8c.html#ac6d4f7a96df89f7a429e64886754e2cc">pcilib_clean_units()</a>, <a class="el" href="error_8h.html#a2b06064fecffd095efabb752f7b50021">pcilib_error</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca480c3c07a5b087945ef9844623f48e9d">PCILIB_ERROR_EXIST</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caa30630d7c09a1fe97acd43439032eb00">PCILIB_ERROR_MEMORY</a>, <a class="el" href="unit_8c.html#acd635e093de3d7d1f5a20e6091c4b950">pcilib_find_unit_by_name()</a>, <a class="el" href="unit_8h.html#a55a044c7ba9ccbc6957623c8571e2eb8">PCILIB_UNIT_INVALID</a>, <a class="el" href="structpcilib__unit__context__s.html#a006b87c0b6c75a405f8629b70be562ad">pcilib_unit_context_s::unit</a>, <a class="el" href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">pcilib_s::unit_hash</a>, <a class="el" href="structpcilib__model__description__t.html#a068c972a2e8dcc0294f195dbe5b6c7c3">pcilib_model_description_t::units</a>, and <a class="el" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">pcilib_s::units</a>.</p>

</div>
</div>
<a id="ac6d4f7a96df89f7a429e64886754e2cc" name="ac6d4f7a96df89f7a429e64886754e2cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6d4f7a96df89f7a429e64886754e2cc">&#9670;&#160;</a></span>pcilib_clean_units()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pcilib_clean_units </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a>&#160;</td>
          <td class="paramname"><em>start</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroys data associated with units. </p>
<p >This is an internal function and will be called during clean-up. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">start</td><td>- specifies first unit to clean (used to clean only part of the units to keep the defined state if pcilib_add_units has failed) </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><span class="lineno">   65</span>                                                            {</div>
<div class="line"><span class="lineno">   66</span>    <a class="code hl_struct" href="structpcilib__unit__context__s.html">pcilib_unit_context_t</a> *s, *tmp;</div>
<div class="line"><span class="lineno">   67</span> </div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">if</span> (ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">unit_hash</a>) {</div>
<div class="line"><span class="lineno">   69</span>        HASH_ITER(hh, ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">unit_hash</a>, s, tmp) {</div>
<div class="line"><span class="lineno">   70</span>            <span class="keywordflow">if</span> (s-&gt;<a class="code hl_variable" href="structpcilib__unit__context__s.html#a006b87c0b6c75a405f8629b70be562ad">unit</a> &gt;= start) {</div>
<div class="line"><span class="lineno">   71</span>                HASH_DEL(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">unit_hash</a>, s);</div>
<div class="line"><span class="lineno">   72</span>                free(s);</div>
<div class="line"><span class="lineno">   73</span>            }</div>
<div class="line"><span class="lineno">   74</span>        }</div>
<div class="line"><span class="lineno">   75</span>    }</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    memset(&amp;ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">units</a>[start], 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="structpcilib__unit__description__t.html">pcilib_unit_description_t</a>));</div>
<div class="line"><span class="lineno">   78</span>    ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">num_units</a> = start;</div>
<div class="line"><span class="lineno">   79</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="structpcilib__s.html#a476d59af0a89bc93b3711a7f35d2632e">pcilib_s::num_units</a>, <a class="el" href="structpcilib__unit__context__s.html#a006b87c0b6c75a405f8629b70be562ad">pcilib_unit_context_s::unit</a>, <a class="el" href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">pcilib_s::unit_hash</a>, and <a class="el" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">pcilib_s::units</a>.</p>

<p class="reference">Referenced by <a class="el" href="unit_8c.html#a9b63096e73a5e91bf520dba108cdd41b">pcilib_add_units()</a>, and <a class="el" href="group__public__api.html#ga809b61586ed9c56a7510c607859e75e3">pcilib_close()</a>.</p>

</div>
</div>
<a id="ab5c8796359ba5bf8917221db1db3fc75" name="ab5c8796359ba5bf8917221db1db3fc75"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5c8796359ba5bf8917221db1db3fc75">&#9670;&#160;</a></span>pcilib_find_transform_by_unit_names()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a> * pcilib_find_transform_by_unit_names </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>from</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find the required transform between two specified units. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">from</td><td>- the source unit </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>- destination unit </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- the pointer to unit transform or NULL in case of error. If no transform required (i.e. <em>from</em> = <em>to</em>), the function will return <a class="el" href="structpcilib__unit__transform__t.html" title="unit transformation routines">pcilib_unit_transform_t</a> structure with <em>transform</em> field set to NULL. </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   97</span>                                                                                                              {</div>
<div class="line"><span class="lineno">   98</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_typedef" href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a> unit;</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">if</span> ((!from)||(!to))</div>
<div class="line"><span class="lineno">  102</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordflow">if</span> (!strcasecmp(from, to)) </div>
<div class="line"><span class="lineno">  105</span>        <span class="keywordflow">return</span> &amp;pcilib_unit_transform_null;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>    unit = <a class="code hl_function" href="unit_8c.html#acd635e093de3d7d1f5a20e6091c4b950">pcilib_find_unit_by_name</a>(ctx, from);</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">if</span> (unit == <a class="code hl_define" href="unit_8h.html#a55a044c7ba9ccbc6957623c8571e2eb8">PCILIB_UNIT_INVALID</a>) <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>    <span class="keywordflow">for</span> (i = 0; ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">units</a>[unit].<a class="code hl_variable" href="structpcilib__unit__description__t.html#a2126c85e864b9de637517d0e72f52cbe">transforms</a>[i].<a class="code hl_variable" href="structpcilib__unit__transform__t.html#a6af1b1ba3635979b3857c6b7f4b65863">unit</a>; i++) {</div>
<div class="line"><span class="lineno">  111</span>        <span class="keywordflow">if</span> (!strcasecmp(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">units</a>[unit].<a class="code hl_variable" href="structpcilib__unit__description__t.html#a2126c85e864b9de637517d0e72f52cbe">transforms</a>[i].<a class="code hl_variable" href="structpcilib__unit__transform__t.html#a6af1b1ba3635979b3857c6b7f4b65863">unit</a>, to))</div>
<div class="line"><span class="lineno">  112</span>            <span class="keywordflow">return</span> &amp;ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">units</a>[unit].<a class="code hl_variable" href="structpcilib__unit__description__t.html#a2126c85e864b9de637517d0e72f52cbe">transforms</a>[i];</div>
<div class="line"><span class="lineno">  113</span>    }</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  116</span>}</div>
<div class="ttc" id="astructpcilib__unit__description__t_html_a2126c85e864b9de637517d0e72f52cbe"><div class="ttname"><a href="structpcilib__unit__description__t.html#a2126c85e864b9de637517d0e72f52cbe">pcilib_unit_description_t::transforms</a></div><div class="ttdeci">pcilib_unit_transform_t transforms[PCILIB_MAX_TRANSFORMS_PER_UNIT+1]</div><div class="ttdoc">Transforms to other units.</div><div class="ttdef"><b>Definition:</b> unit.h:25</div></div>
<div class="ttc" id="astructpcilib__unit__transform__t_html_a6af1b1ba3635979b3857c6b7f4b65863"><div class="ttname"><a href="structpcilib__unit__transform__t.html#a6af1b1ba3635979b3857c6b7f4b65863">pcilib_unit_transform_t::unit</a></div><div class="ttdeci">char * unit</div><div class="ttdoc">Name of the resulting unit.</div><div class="ttdef"><b>Definition:</b> unit.h:19</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="unit_8c.html#acd635e093de3d7d1f5a20e6091c4b950">pcilib_find_unit_by_name()</a>, <a class="el" href="unit_8h.html#a55a044c7ba9ccbc6957623c8571e2eb8">PCILIB_UNIT_INVALID</a>, <a class="el" href="structpcilib__unit__description__t.html#a2126c85e864b9de637517d0e72f52cbe">pcilib_unit_description_t::transforms</a>, <a class="el" href="structpcilib__unit__transform__t.html#a6af1b1ba3635979b3857c6b7f4b65863">pcilib_unit_transform_t::unit</a>, and <a class="el" href="structpcilib__s.html#a05d5ea2f170c18f320ae1ce7d05e378f">pcilib_s::units</a>.</p>

<p class="reference">Referenced by <a class="el" href="unit_8c.html#a3ba0687e6afff19be2628811c6220e90">pcilib_transform_unit_by_name()</a>.</p>

</div>
</div>
<a id="aaa472057642cac1d33d81aa803bc6c5f" name="aaa472057642cac1d33d81aa803bc6c5f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa472057642cac1d33d81aa803bc6c5f">&#9670;&#160;</a></span>pcilib_find_unit_by_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="pcilib_8h.html#ad969fce8a73484aa5f74ba8c125427b8">pcilib_unit_t</a> pcilib_find_unit_by_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>unit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find unit id using supplied name. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">unit</td><td>- the requested unit name </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- unit id or PCILIB_UNIT_INVALID if error not found or error has occured </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">   81</span>                                                                        {</div>
<div class="line"><span class="lineno">   82</span>    <a class="code hl_struct" href="structpcilib__unit__context__s.html">pcilib_unit_context_t</a> *unit_ctx = NULL;</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>    HASH_FIND_STR(ctx-&gt;<a class="code hl_variable" href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">unit_hash</a>, name, unit_ctx);</div>
<div class="line"><span class="lineno">   85</span>    <span class="keywordflow">if</span> (unit_ctx) <span class="keywordflow">return</span> unit_ctx-&gt;<a class="code hl_variable" href="structpcilib__unit__context__s.html#a006b87c0b6c75a405f8629b70be562ad">unit</a>;</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span><span class="comment">/*</span></div>
<div class="line"><span class="lineno">   88</span><span class="comment">    pcilib_unit_t i;</span></div>
<div class="line"><span class="lineno">   89</span><span class="comment">    for(i = 0; ctx-&gt;units[i].name; i++) {</span></div>
<div class="line"><span class="lineno">   90</span><span class="comment">        if (!strcasecmp(ctx-&gt;units[i].name, name))</span></div>
<div class="line"><span class="lineno">   91</span><span class="comment">            return i;</span></div>
<div class="line"><span class="lineno">   92</span><span class="comment">    }</span></div>
<div class="line"><span class="lineno">   93</span><span class="comment">*/</span></div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="unit_8h.html#a55a044c7ba9ccbc6957623c8571e2eb8">PCILIB_UNIT_INVALID</a>;</div>
<div class="line"><span class="lineno">   95</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="unit_8h.html#a55a044c7ba9ccbc6957623c8571e2eb8">PCILIB_UNIT_INVALID</a>, <a class="el" href="structpcilib__unit__context__s.html#a006b87c0b6c75a405f8629b70be562ad">pcilib_unit_context_s::unit</a>, and <a class="el" href="structpcilib__s.html#a6726f3274210ed8e3a2afeebac1f10c8">pcilib_s::unit_hash</a>.</p>

<p class="reference">Referenced by <a class="el" href="unit_8c.html#a9b63096e73a5e91bf520dba108cdd41b">pcilib_add_units()</a>, <a class="el" href="group__public__api__value.html#ga3f2ffc810ad5353dcb7072f4ae1fa392">pcilib_convert_value_unit()</a>, and <a class="el" href="unit_8c.html#ab5c8796359ba5bf8917221db1db3fc75">pcilib_find_transform_by_unit_names()</a>.</p>

</div>
</div>
<a id="a95f01e52d74bdb197b8c37466f854263" name="a95f01e52d74bdb197b8c37466f854263"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95f01e52d74bdb197b8c37466f854263">&#9670;&#160;</a></span>pcilib_transform_unit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_transform_unit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a> *&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts value to the requested units. </p>
<p >It is error to convert values with unspecified units. This is internal function, use pcilib_value_convert_value_unit instead. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">trans</td><td>- the requested unit transform </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">value</td><td>- the value to be converted (changed on success) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  118</span>                                                                                                      {</div>
<div class="line"><span class="lineno">  119</span>    <span class="keywordtype">int</span> err;</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">if</span> (trans-&gt;<a class="code hl_variable" href="structpcilib__unit__transform__t.html#a94b3328c1e159d6e578e5894e3fa7897">transform</a>) {</div>
<div class="line"><span class="lineno">  122</span>        err = <a class="code hl_function" href="py_8c.html#a10aa2e4e4798032fdf81b23458faacb0">pcilib_py_eval_string</a>(ctx, trans-&gt;<a class="code hl_variable" href="structpcilib__unit__transform__t.html#a94b3328c1e159d6e578e5894e3fa7897">transform</a>, value);</div>
<div class="line"><span class="lineno">  123</span>        <span class="keywordflow">if</span> (err) <span class="keywordflow">return</span> err;</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>        value-&gt;<a class="code hl_variable" href="structpcilib__value__t.html#ad5adcdc4bdcabfa18219db82b3f465e4">unit</a> = trans-&gt;<a class="code hl_variable" href="structpcilib__unit__transform__t.html#a6af1b1ba3635979b3857c6b7f4b65863">unit</a>;</div>
<div class="line"><span class="lineno">  126</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (trans-&gt;<a class="code hl_variable" href="structpcilib__unit__transform__t.html#a6af1b1ba3635979b3857c6b7f4b65863">unit</a>) {</div>
<div class="line"><span class="lineno">  127</span>        value-&gt;<a class="code hl_variable" href="structpcilib__value__t.html#ad5adcdc4bdcabfa18219db82b3f465e4">unit</a> = trans-&gt;<a class="code hl_variable" href="structpcilib__unit__transform__t.html#a6af1b1ba3635979b3857c6b7f4b65863">unit</a>;</div>
<div class="line"><span class="lineno">  128</span>    } </div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  131</span>}</div>
<div class="ttc" id="apy_8c_html_a10aa2e4e4798032fdf81b23458faacb0"><div class="ttname"><a href="py_8c.html#a10aa2e4e4798032fdf81b23458faacb0">pcilib_py_eval_string</a></div><div class="ttdeci">int pcilib_py_eval_string(pcilib_t *ctx, const char *codestr, pcilib_value_t *value)</div><div class="ttdoc">Evaluates the specified python code and returns result in val.</div><div class="ttdef"><b>Definition:</b> py.c:734</div></div>
<div class="ttc" id="astructpcilib__unit__transform__t_html_a94b3328c1e159d6e578e5894e3fa7897"><div class="ttname"><a href="structpcilib__unit__transform__t.html#a94b3328c1e159d6e578e5894e3fa7897">pcilib_unit_transform_t::transform</a></div><div class="ttdeci">char * transform</div><div class="ttdoc">String, similar to view formula, explaining transform to this unit.</div><div class="ttdef"><b>Definition:</b> unit.h:20</div></div>
<div class="ttc" id="astructpcilib__value__t_html_ad5adcdc4bdcabfa18219db82b3f465e4"><div class="ttname"><a href="structpcilib__value__t.html#ad5adcdc4bdcabfa18219db82b3f465e4">pcilib_value_t::unit</a></div><div class="ttdeci">const char * unit</div><div class="ttdoc">Units (if known)</div><div class="ttdef"><b>Definition:</b> pcilib.h:125</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="py_8c.html#a10aa2e4e4798032fdf81b23458faacb0">pcilib_py_eval_string()</a>, <a class="el" href="structpcilib__unit__transform__t.html#a94b3328c1e159d6e578e5894e3fa7897">pcilib_unit_transform_t::transform</a>, <a class="el" href="structpcilib__value__t.html#ad5adcdc4bdcabfa18219db82b3f465e4">pcilib_value_t::unit</a>, and <a class="el" href="structpcilib__unit__transform__t.html#a6af1b1ba3635979b3857c6b7f4b65863">pcilib_unit_transform_t::unit</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__public__api__register.html#ga6f2c0b85f32a7aaacfe60081641593f6">pcilib_read_register_view_by_id()</a>, <a class="el" href="unit_8c.html#a3ba0687e6afff19be2628811c6220e90">pcilib_transform_unit_by_name()</a>, and <a class="el" href="group__public__api__register.html#ga96c489b3a922154cf50c89fb157808cc">pcilib_write_register_view_by_id()</a>.</p>

</div>
</div>
<a id="a3ba0687e6afff19be2628811c6220e90" name="a3ba0687e6afff19be2628811c6220e90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ba0687e6afff19be2628811c6220e90">&#9670;&#160;</a></span>pcilib_transform_unit_by_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pcilib_transform_unit_by_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="kmem_8h.html#a51f63ba035402ca9a2ddd1b11152d7f5">pcilib_t</a> *&#160;</td>
          <td class="paramname"><em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>to</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structpcilib__value__t.html">pcilib_value_t</a> *&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Converts value to the requested units. </p>
<p >It is error to convert values with unspecified units. This is internal function, use pcilib_value_convert_value_unit instead. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">ctx</td><td>- pcilib context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">to</td><td>- specifies the requested unit of the value </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">value</td><td>- the value to be converted (changed on success) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>- error or 0 on success </dd></dl>
<div class="fragment"><div class="line"><span class="lineno">  134</span>                                                                                        {</div>
<div class="line"><span class="lineno">  135</span>    <a class="code hl_struct" href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a> *trans;</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">if</span> (!value-&gt;<a class="code hl_variable" href="structpcilib__value__t.html#ad5adcdc4bdcabfa18219db82b3f465e4">unit</a>) {</div>
<div class="line"><span class="lineno">  138</span>        <a class="code hl_define" href="error_8h.html#a62fff84bc7941d1a39700b931716bbe9">pcilib_warning</a>(<span class="stringliteral">&quot;Can&#39;t transform unit of the value with unspecified unit&quot;</span>);</div>
<div class="line"><span class="lineno">  139</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca1d5267b325c591675a462cefbb1d0f7f">PCILIB_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><span class="lineno">  140</span>    }</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>    trans = <a class="code hl_function" href="unit_8c.html#ab5c8796359ba5bf8917221db1db3fc75">pcilib_find_transform_by_unit_names</a>(ctx, value-&gt;<a class="code hl_variable" href="structpcilib__value__t.html#ad5adcdc4bdcabfa18219db82b3f465e4">unit</a>, to);</div>
<div class="line"><span class="lineno">  143</span>    <span class="keywordflow">if</span> (!trans) {</div>
<div class="line"><span class="lineno">  144</span>        <a class="code hl_define" href="error_8h.html#a62fff84bc7941d1a39700b931716bbe9">pcilib_warning</a>(<span class="stringliteral">&quot;Can&#39;t transform unit (%s) to (%s)&quot;</span>, value-&gt;<a class="code hl_variable" href="structpcilib__value__t.html#ad5adcdc4bdcabfa18219db82b3f465e4">unit</a>, to);</div>
<div class="line"><span class="lineno">  145</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>;</div>
<div class="line"><span class="lineno">  146</span>    }</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="unit_8c.html#a95f01e52d74bdb197b8c37466f854263">pcilib_transform_unit</a>(ctx, trans, value);</div>
<div class="line"><span class="lineno">  149</span>}</div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60ca1d5267b325c591675a462cefbb1d0f7f"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca1d5267b325c591675a462cefbb1d0f7f">PCILIB_ERROR_INVALID_ARGUMENT</a></div><div class="ttdeci">@ PCILIB_ERROR_INVALID_ARGUMENT</div><div class="ttdef"><b>Definition:</b> error.h:20</div></div>
<div class="ttc" id="aerror_8h_html_a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c"><div class="ttname"><a href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a></div><div class="ttdeci">@ PCILIB_ERROR_NOTSUPPORTED</div><div class="ttdef"><b>Definition:</b> error.h:24</div></div>
<div class="ttc" id="aerror_8h_html_a62fff84bc7941d1a39700b931716bbe9"><div class="ttname"><a href="error_8h.html#a62fff84bc7941d1a39700b931716bbe9">pcilib_warning</a></div><div class="ttdeci">#define pcilib_warning(...)</div><div class="ttdef"><b>Definition:</b> error.h:69</div></div>
<div class="ttc" id="astructpcilib__unit__transform__t_html"><div class="ttname"><a href="structpcilib__unit__transform__t.html">pcilib_unit_transform_t</a></div><div class="ttdoc">unit transformation routines</div><div class="ttdef"><b>Definition:</b> unit.h:18</div></div>
<div class="ttc" id="aunit_8c_html_a95f01e52d74bdb197b8c37466f854263"><div class="ttname"><a href="unit_8c.html#a95f01e52d74bdb197b8c37466f854263">pcilib_transform_unit</a></div><div class="ttdeci">int pcilib_transform_unit(pcilib_t *ctx, const pcilib_unit_transform_t *trans, pcilib_value_t *value)</div><div class="ttdoc">Converts value to the requested units.</div><div class="ttdef"><b>Definition:</b> unit.c:118</div></div>
<div class="ttc" id="aunit_8c_html_ab5c8796359ba5bf8917221db1db3fc75"><div class="ttname"><a href="unit_8c.html#ab5c8796359ba5bf8917221db1db3fc75">pcilib_find_transform_by_unit_names</a></div><div class="ttdeci">pcilib_unit_transform_t * pcilib_find_transform_by_unit_names(pcilib_t *ctx, const char *from, const char *to)</div><div class="ttdoc">Find the required transform between two specified units.</div><div class="ttdef"><b>Definition:</b> unit.c:97</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60ca1d5267b325c591675a462cefbb1d0f7f">PCILIB_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="error_8h.html#a0c59f7091fd2446121868635aca9e60caf5392ef1a23835f44ebfe662e3d2988c">PCILIB_ERROR_NOTSUPPORTED</a>, <a class="el" href="unit_8c.html#ab5c8796359ba5bf8917221db1db3fc75">pcilib_find_transform_by_unit_names()</a>, <a class="el" href="unit_8c.html#a95f01e52d74bdb197b8c37466f854263">pcilib_transform_unit()</a>, <a class="el" href="error_8h.html#a62fff84bc7941d1a39700b931716bbe9">pcilib_warning</a>, and <a class="el" href="structpcilib__value__t.html#ad5adcdc4bdcabfa18219db82b3f465e4">pcilib_value_t::unit</a>.</p>

<p class="reference">Referenced by <a class="el" href="group__public__api__value.html#ga3f2ffc810ad5353dcb7072f4ae1fa392">pcilib_convert_value_unit()</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 18 2024 22:02:48 for pcilib by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
